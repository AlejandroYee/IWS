/*
* Copyright (c) 2014 - Andrey Boomer - andrey.boomer at gmail.com
* icq: 454169
* Licensed under the MIT license:
*   http://www.opensource.org/licenses/mit-license.php
*/
(function(c){c.widget("ui.SlidebarMenu",{options:{position:"left",width:"15",bodyElement:"#slidebarmenu-body",animation_amount:500,onClose:null,onOpen:null},_create:function(){var a=this,b=a.element,e=c(this.options.bodyElement),d="left"===this.options.position?"-"+c(window).width()/100*this.options.width:c(window).width();b.addClass("ui-widget ui-state-default slidebar");b.css("background-image","none");b.css("left",d+"px");b.css("width",this.options.width+"%");e.css("position","relative");b.hide();
this._CreateMenu(b);b.on("touchend click",function(d){a._eventHandler(d,c(this));a.toggle()});e.on("touchend click",function(d){a._eventHandler(d,c(this));a.close()})},_CreateMenu:function(a){var b=this,e=this.options;c.each(a.children("li"),function(){var a=c(this);if(""===a.text())a.addClass("ui-state-default slidebar-item slidebar-item-empty").css("float",e.position).css("background-image","none");else if(a.addClass("ui-state-default slidebar-item").css("float",e.position).css("background-image",
"none"),pls=a.children("a").html(),a.children("a").empty().append(c("<span />").append(pls)),a.children("a").find("span").css("float",e.position),""!==a.children("a").attr("onClick")&&a.attr("onClick",a.children("a").attr("onClick")),a.children("a").removeAttr("onClick"),a.on({mouseenter:function(){a.addClass("ui-state-hover")},mouseleave:function(){a.removeClass("ui-state-hover")},"touchend click":function(){var a=c(this);if("true"===a.attr("has_menu")){var d=a.next("ul");a.addClass("ui-state-active");
"true"===d.attr("opened")?(d.slideUp(e.animation_amount),a.removeClass("ui-state-active"),d.attr("opened",!1)):(a.parent().children("ul[opened]").slideUp(e.animation_amount).attr("opened",!1),a.parent().children(".ui-state-active").removeClass("ui-state-active"),d.slideDown(e.animation_amount),d.attr("opened",!0));return!1}b.close()}}),0<a.children("ul").length){var f=a.children("ul");f.addClass("slidebar-menu");a.attr("has_menu",!0);a.children("a").append(c("<span>").attr({"class":"ui-icon ui-icon-triangle-1-s",
style:"float:left"}));f.insertAfter(a).hide().attr("opened",!1);b._CreateMenu(f)}else a.css("border","0px"),a.attr("has_menu",!1)})},_eventHandler:function(a,b){a.stopPropagation();a.preventDefault();"touchend"===a.type&&b.off("click")},toggle:function(){var a=this.element;"false"===a.attr("active")||void 0===a.attr("active")?this.open():this.close()},close:function(){var a=this.options;"true"===this.element.attr("active")&&(c.isFunction(a.onClose)?a.onClose.call()&&this._animate_hide():this._animate_hide())},
open:function(){var a=this.options;"true"!==this.element.attr("active")&&(c.isFunction(a.onOpen)?a.onOpen.call()&&this._animate_show():this._animate_show())},_animate_hide:function(){var a=this.options,b=this.element,e=c(this.options.bodyElement);e.add(b);var d;d="left"===a.position?"-"+c(window).width()/100*a.width:c(window).width();b.stop().animate({left:d},a.animation_amount);e.stop().animate({left:0},a.animation_amount);setTimeout(function(){b.hide();b.attr("active",!1)},a.animation_amount)},
_animate_show:function(){var a=this.options,b=this.element,e=c(this.options.bodyElement).add(b),d="left"===a.position?"+="+c(window).width()/100*a.width:"-="+c(window).width()/100*a.width;b.show();e.stop().animate({left:d},a.animation_amount);setTimeout(function(){b.attr("active",!0)},a.animation_amount)},_setOption:function(a,b){c.Widget.prototype._setOption.apply(this,arguments)}})})(jQuery);