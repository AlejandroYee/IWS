/*
 Andrey Lysikov (C) 2014
 Licensed under the MIT license:
   http://www.opensource.org/licenses/mit-license.php
*/
(function(e){e.widget("ui.SlidebarMenu",{options:{position:"left",width:"15",bodyElement:"#slidebarmenu-body",animation_amount:300,minwidth:250,resizable:!1,onClose:null,onOpen:null},_create:function(){var a=this,c=a.element,d=e(this.options.bodyElement),b=e(window).width();b/100*this.options.width>this.options.minwidth?c.width(b/100*this.options.width):c.width(this.options.minwidth);if("left"===this.options.position){var f="-"+c.width();d.width(b-c.width()-f)}else f=b,d.width(b);c.css("left",f+"px");
c.addClass("ui-widget ui-state-default slidebar slidebar-animate");c.css("background-image","none");d.addClass("slidebar-animate").css("position","relative");this.options.resizable&&c.resizable({handles:"left"===this.options.position?"e":"w",resize:function(b,c){a.resize(c.size.width)}});this._CreateMenu(c);d.on("click",function(b){a.close()})},_CreateMenu:function(a){var c=this,d=this.options;e.each(a.children("li"),function(){var b=e(this);if(""===b.text())b.addClass("ui-state-default slidebar-item slidebar-item-empty").css("float",
"left").css("background-image","none");else if(b.addClass("ui-state-default slidebar-item").css("float","left").css("background-image","none"),clc=b.children("a").attr("onClick"),"div"===b.parent()[0].localName&&(pls=b.children("a").html(),b.children("a").empty().append(e("<span />").append(pls)),b.width("100%")),b.children("a").find("span").css("float","left"),""!==clc&&b.attr("onClick",clc),b.children("a").removeAttr("onClick"),b.on({mouseenter:function(a){b.addClass("ui-state-hover")},mouseleave:function(a){b.removeClass("ui-state-hover")},
click:function(a){a=e(this);if("true"===a.attr("has_menu")){var b=a.next("ul");"true"===b.attr("opened")?(a.children("a").children(".ui-icon-circlesmall-minus").removeClass("ui-icon-circlesmall-minus").addClass("ui-icon-circlesmall-plus"),a.removeClass("ui-state-active"),b.attr("opened",!1),b.slideUp(d.animation_amount)):(a.parent().children("ul[opened]").attr("opened",!1).slideUp(d.animation_amount).prev().children("a").children(".ui-icon-circlesmall-minus").removeClass("ui-icon-circlesmall-minus").addClass("ui-icon-circlesmall-plus"),
a.parent().children(".ui-state-active").removeClass("ui-state-active"),a.children("a").children(".ui-icon-circlesmall-plus").removeClass("ui-icon-circlesmall-plus").addClass("ui-icon-circlesmall-minus"),b.attr("opened",!0),a.addClass("ui-state-active"),b.slideDown(d.animation_amount));return!1}c.close()}}),0<b.children("ul").length){var a=b.children("ul");a.addClass("slidebar-menu showUp");b.attr("has_menu",!0);e("<span>").attr({"class":"ui-icon ui-icon-circlesmall-plus",style:"float:left"}).insertBefore(b.children("a").children("span:first"));
a.insertAfter(b).hide().attr("opened",!1);b.css("border","0px");c._CreateMenu(a)}else b.css("border","0px"),b.attr("has_menu",!1)})},resize:function(a){var c=this.element,d=e(this.options.bodyElement),b=e(window).width();"undefined"===typeof a&&(a=c.width());a>this.options.minwidth?c.width(a):c.width(this.options.minwidth);"true"!==c.attr("active")?"left"===this.options.position?(a="-"+c.width(),d.css("left","0px")):(a=b,d.css("left",b+"px")):"left"===this.options.position?(a=0,d.css("left",+(a+c.width())+
"px")):(a=b-c.width(),d.css("left",+-c.width()+"px"));d.width(b);c.css("left",a+"px")},toggle:function(){var a=this.element;"false"===a.attr("active")||void 0===a.attr("active")?this.open():this.close()},close:function(){var a=this.options;"true"===this.element.attr("active")&&(e.isFunction(a.onClose)?a.onClose.call()&&this._animate_hide():this._animate_hide())},open:function(){var a=this.options;"true"!==this.element.attr("active")&&(e.isFunction(a.onOpen)?a.onOpen.call()&&this._animate_show():this._animate_show())},
_animate_hide:function(){var a=this.element,c=e(this.options.bodyElement),d=e(window).width();if("left"===this.options.position){var b="-"+a.width();c.css("left","0px")}else b=d,c.css("left",d+"px");c.width(d);a.css("left",b+"px");setTimeout(function(){a.attr("active",!1)},this.options.animation_amount)},_animate_show:function(){var a=this.element,c=e(this.options.bodyElement),d=e(window).width();if("left"===this.options.position){var b=0;c.css("left",+(b+a.width())+"px")}else b=d-a.width(),c.css("left",
+-a.width()+"px");c.width(d);a.css("left",b+"px");setTimeout(function(){a.attr("active",!0)},this.options.animation_amount)},_setOption:function(a,c){e.Widget.prototype._setOption.apply(this,arguments)}})})(jQuery);