/*
 Andrey Lysikov (C) 2014
 Licensed under the MIT license:
   http://www.opensource.org/licenses/mit-license.php
*/
(function(c){c.widget("ui.SlidebarMenu",{options:{position:"left",width:"15",bodyElement:"#slidebarmenu-body",animation_amount:500,onClose:null,onOpen:null},_create:function(){var a=this,b=a.element,d=c(this.options.bodyElement),e="left"===this.options.position?"-"+c(window).width()/100*this.options.width:c(window).width();b.addClass("ui-widget ui-state-default slidebar");b.css("background-image","none");b.css("left",e+"px");b.css("width",this.options.width+"%");d.css("position","relative");b.hide();
this._CreateMenu(b);b.on("touchend click",function(e){a._eventHandler(e,c(this));a.toggle()});d.on("touchend click",function(e){a._eventHandler(e,c(this));a.close()})},_CreateMenu:function(a){var b=this,d=this.options;c.each(a.children("li"),function(){var a=c(this);if(""===a.text())a.addClass("ui-state-default slidebar-item slidebar-item-empty").css("float",d.position).css("background-image","none");else if(a.addClass("ui-state-default slidebar-item").css("float",d.position).css("background-image",
"none"),clc=a.children("a").attr("onClick"),"div"===a.parent()[0].localName&&(pls=a.children("a").html(),a.children("a").empty().append(c("<span />").append(pls)),a.width(b.element.width())),a.children("a").find("span").css("float",d.position),""!==clc&&a.attr("onClick",clc),a.children("a").removeAttr("onClick"),a.on({mouseenter:function(d){b._eventHandler(d,c(this));a.addClass("ui-state-hover")},mouseleave:function(d){b._eventHandler(d,c(this));a.removeClass("ui-state-hover")},"touchend click":function(a){b._eventHandler(a,
c(this));a=c(this);if("true"===a.attr("has_menu")){var e=a.next("ul");"true"===e.attr("opened")?(a.children("a").children(".ui-icon-circlesmall-minus").removeClass("ui-icon-circlesmall-minus").addClass("ui-icon-circlesmall-plus"),e.slideUp(d.animation_amount),a.removeClass("ui-state-active"),e.attr("opened",!1)):(a.parent().children("ul[opened]").slideUp(d.animation_amount).attr("opened",!1),a.parent().children(".ui-state-active").removeClass("ui-state-active"),e.slideDown(d.animation_amount),a.children("a").children(".ui-icon-circlesmall-plus").removeClass("ui-icon-circlesmall-plus").addClass("ui-icon-circlesmall-minus"),
e.attr("opened",!0),a.addClass("ui-state-active"));return!1}b.close()}}),0<a.children("ul").length){var f=a.children("ul");f.addClass("slidebar-menu");a.attr("has_menu",!0);c("<span>").attr({"class":"ui-icon ui-icon-circlesmall-plus",style:"float:left"}).insertBefore(a.children("a").children("span:first"));f.insertAfter(a).hide().attr("opened",!1);a.css("border","0px");b._CreateMenu(f)}else a.css("border","0px"),a.attr("has_menu",!1)})},_eventHandler:function(a,b){a.stopPropagation();a.preventDefault();
"touchend"===a.type&&b.off("click")},toggle:function(){var a=this.element;"false"===a.attr("active")||void 0===a.attr("active")?this.open():this.close()},close:function(){var a=this.options;"true"===this.element.attr("active")&&(c.isFunction(a.onClose)?a.onClose.call()&&this._animate_hide():this._animate_hide())},open:function(){var a=this.options;"true"!==this.element.attr("active")&&(c.isFunction(a.onOpen)?a.onOpen.call()&&this._animate_show():this._animate_show())},_animate_hide:function(){var a=
this.options,b=this.element,d=c(this.options.bodyElement);d.add(b);var e;e="left"===a.position?"-"+c(window).width()/100*a.width:c(window).width();b.stop().animate({left:e},a.animation_amount);d.stop().animate({left:0},a.animation_amount);setTimeout(function(){b.hide();b.attr("active",!1)},a.animation_amount)},_animate_show:function(){var a=this.options,b=this.element,d=c(this.options.bodyElement).add(b),e="left"===a.position?"+="+c(window).width()/100*a.width:"-="+c(window).width()/100*a.width;b.show();
d.stop().animate({left:e},a.animation_amount);setTimeout(function(){b.attr("active",!0)},a.animation_amount)},_setOption:function(a,b){c.Widget.prototype._setOption.apply(this,arguments)}})})(jQuery);