/*
* Autor Andrey Lysikov (C) 2014
* Licensed under the MIT license:
*   http://www.opensource.org/licenses/mit-license.php
* Part of IWS system
* 
*/
$.jgrid.extend({editGridRow:function(k,f){f=$.extend(!0,{modal:!0,resize:!0,mtype:"POST",addedrow:"last",reloadAfterSubmit:!0,beforeSubmit:null,afterSubmit:null,recreateForm:!1,closeOnEscape:!1,serializeEditData:null},$.jgrid.edit,f||{});var a=this;CreateEditDialog=function(e){var h=a.jqGrid("getGridParam","colModel"),g=a.jqGrid("getGridParam","colNames"),m=a.jqGrid("getGridParam","treeGrid"),b=a.attr("id"),c=$("<form />").attr({name:"FormPost",id:"editmod"+b,onsubmit:"return false;",style:"text-align: left;"}),
u=$("<table />").attr({id:"TblGrid_"+b,"class":"EditTable",cellspacing:"0",cellpadding:"0",border:"0"});$("#dialog_editmod"+b).dialog("destroy").remove();$(h).each(function(b){if("undefined"!==typeof h[b].editoptions){var a="",c="";$.each(h[b].editoptions,function(b,a){"value"!==b&&(c=c+b+'="'+a+'" ')});h[b].editable||(h[b].hidden=!0);h[b].edittype||(h[b].edittype="text");switch(h[b].edittype){case "text":a='<input class="FormElement ui-widget-content ui-corner-all" id="'+h[b].index+'" name="'+h[b].index+
'" type="text" '+c+' value="'+e[h[b].index]+'" />';break;case "checkbox":"1"===e[h[b].index]&&(c+='checked="checked"');a='<input class="FormElement ui-widget-content ui-corner-all" id="'+h[b].index+'" name="'+h[b].index+'" type="checkbox" '+c+" />";break;case "password":a='<input class="FormElement ui-widget-content ui-corner-all" id="'+h[b].index+'" name="'+h[b].index+'" type="password" '+c+' value="" />';break;case "textarea":a='<textarea class="FormElement ui-widget-content ui-corner-all" id="'+
h[b].index+'" '+c+' name="'+h[b].index+'" >'+e[h[b].index]+"</textarea>";break;case "select":a='<select class="FormElement ui-widget-content ui-corner-all" id="'+h[b].index+'" '+c+' name="'+h[b].index+'"  >',$.each(h[b].editoptions.value.split(";"),function(c,d){sel="";el=d.split(":");val=h[b].editoptions.multiple?e[h[b].index].split(","):e[h[b].index].split("~|");$.each(val,function(b,a){$.trim(a)===$.trim(el[0])&&(sel="selected")});a=a+'<option value="'+el[0]+'" '+sel+">"+el[1]+"</option>"}),a+=
"</select>"}h[b].editoptions.title||(h[b].editoptions.title="");table_elements=$("<tr />").attr({id:"tr_"+h[b].index,"class":"FormData",title:h[b].editoptions.title,style:h[b].hidden?"display:none":""});table_elements.append($("<td />").attr({"class":"CaptionTD",style:"width:150px;"}).append(g[b]));table_elements.append($("<td />").attr({"class":"DataTD"}).append(a));u.append(table_elements)}});if($.isFunction(create_from_table_elements)){$.isFunction(replace_select_opt_group)&&replace_select_opt_group(u);
var d=create_from_table_elements(u)+200+60}else d=710;c.append(u);c.append('<input type="hidden" name="id" value="'+k+'"><input type="hidden" name="oper" value="edit">');bSubmit=$.jgrid.edit.bSubmit;bCancel=$.jgrid.edit.bCancel;$("<div>").attr({id:"dialog_editmod"+a.attr("id"),"class":"FormElement ui-jqdialog-content"}).append(c).dialog({autoOpen:!1,modal:!1,minWidth:450,width:d,appendTo:$(".ui-tabs-panel[aria-expanded='true']").children(".tab_main_content"),closeOnEscape:f.closeOnEscape,resizable:f.resize,
buttons:[{text:bSubmit,click:function(){var c=$(this),d=[];$.each($("#editmod"+b).find("input, select, textarea"),function(){var b=$(this);d[b.attr("name")]=b.val()});d=$.extend({},d);"new"===d.id&&(d.oper="add",m&&(d.ID_PARENT=a.jqGrid("getGridParam","selrow")));var e=!0;$.isFunction(f.serializeEditData)&&(d=f.serializeEditData.call(f,d));$.isFunction(f.beforeSubmit)&&(ret=f.beforeSubmit.call(f,d,$("#editmod"+b)),e="undefined"!==typeof ret?ret[0]:!1);e&&($("#btn_s_"+b).button("option","disabled",
!0),$("#btn_c_"+b).button("option","disabled",!0),$.ajax({url:a.jqGrid("getGridParam","editurl"),datatype:"json",data:d,cache:!1,type:f.mtype,success:function(h,g){e=!0;var p={};p.statusText=g;p.responseText=h;$.isFunction(f.afterSubmit)&&(ret=f.afterSubmit.call(f,p,d,b),e="undefined"!==typeof ret?ret[0]:!1);e&&("add"!==d.oper?a.jqGrid("setRowData",k,d):m?a.jqGrid("addChildNode",ret[3],d.ID_PARENT,d):a.jqGrid("addRowData",ret[3],d,f.addedrow),c.dialog("close"));$("#btn_s_"+b).button("option","disabled",
!1);$("#btn_c_"+b).button("option","disabled",!1)}}))}},{text:bCancel,click:function(){$(this).dialog("close")}}],close:function(){$(this).parent().parent().children(".ui-widget-overlay").remove();$(this).dialog("close")},open:function(){var a=$(this).parent();a.children(".ui-dialog-buttonpane").find('button:contains("'+bCancel+'")').button({icons:{primary:"ui-icon-close"}}).prop("id","btn_c_"+b);a.children(".ui-dialog-buttonpane").find('button:contains("'+bSubmit+'")').button({icons:{primary:"ui-icon-disk"}}).prop("id",
"btn_s_"+b);$($("<div />").attr({"class":"ui-widget-overlay ui-front dialog_jqgrid_overlay ui-corner-all",style:"position:absolute;z-index:99"})).prependTo(a.parent());redraw_document()}})};var e=$("#editmod"+a.attr("id"));if("new"!==k)var l=a.jqGrid("getRowData",k);else{var l=[],m=a.jqGrid("getGridParam","colModel");$(m).each(function(a){"undefined"!==typeof m[a].editoptions&&(l[m[a].index]="")});l=$.extend({},l)}f.recreateForm||0===e.length?CreateEditDialog(l):(e=$("#editmod"+a.attr("id")),$.each(l,
function(a,e){var g=$("#"+a);"SB"===g.attr("row_type")?(g.children("option").removeAttr("selected"),e=g.attr("multiple")?e.split(","):e.split("~|"),$.each(e,function(a,b){g.find("option[value='"+$.trim(b)+"']").attr("selected","")})):"B"===g.attr("row_type")?"1"===e?g.attr({checked:"checked"}):g.removeAttr("checked"):g.val(e)}),$.isFunction(replace_select_opt_group)&&replace_select_opt_group(e),$.isFunction(update_table_elemnts)&&update_table_elemnts(e));e.find('input[name="oper"]').val("edit");e.find('input[name="id"]').val(k);
$("#dialog_editmod"+a.attr("id")).dialog("option","title",f.editCaption).dialog("open")},viewGridRow:function(k,f){f=$.extend(!0,{modal:!1,resize:!0,closeOnEscape:!1,viewPagerButtons:!0},$.jgrid.view,f||{});var a=0,e=this.jqGrid("getGridParam","colModel"),l=this.jqGrid("getGridParam","colNames"),m=this.attr("id"),p=this.jqGrid("getRowData",k),h=$("<table />").attr({id:"TblGrid_"+m,"class":"EditTable",cellspacing:"0",cellpadding:"0",border:"0"});$(e).each(function(g){if("undefined"!==typeof e[g].editoptions){e[g].edittype||
(e[g].edittype="text");e[g].editable||(e[g].hidden=!0);var f="disabled ";$.each(e[g].editoptions,function(b,c){"value"!==b&&("w"===b&&(parseInt(c)>a&&(a=parseInt(c)),b="style",c="width:"+c+"px;"),f=f+b+'="'+c+'" ')});switch(e[g].edittype){case "text":elem='<input class="FormElement ui-widget-content ui-corner-all"  type="text" '+f+' value="'+p[e[g].index]+'" />';break;case "checkbox":"1"===p[e[g].index]&&(f+='checked="checked"');elem='<input class="FormElement ui-widget-content ui-corner-all" type="checkbox" '+
f+" />";break;case "password":elem='<input class="FormElement ui-widget-content ui-corner-all" type="password" '+f+' value="" />';break;case "textarea":elem='<textarea class="FormElement ui-widget-content ui-corner-all" '+f+">"+p[e[g].index]+"</textarea>";break;case "select":case "select":elem='<select class="FormElement ui-widget-content ui-corner-all"  '+f+"  >",$.each(e[g].editoptions.value.split(";"),function(b,a){sel="";el=a.split(":");val=e[g].editoptions.multiple?p[e[g].index].split(","):p[e[g].index].split("~|");
$.each(val,function(b,a){$.trim(a)===$.trim(el[0])&&(sel="selected")});elem=elem+'<option value="'+el[0]+'" '+sel+">"+el[1]+"</option>"}),elem+="</select>"}e[g].editoptions.title||(e[g].editoptions.title="");table_elements=$("<tr />").attr({id:"tr_"+e[g].index,"class":"FormData",title:e[g].editoptions.title,style:e[g].hidden?"display:none":""});table_elements.append($("<td />").attr({"class":"CaptionTD",style:"width:150px;text-align:left;padding:5px;"}).append("<b>"+l[g]+"</b>"));table_elements.append($("<td />").attr({"class":"DataTD",
style:"text-align:left;padding:5px;"}).append(elem));h.append(table_elements)}});$("<div>").attr({id:"dialog_viewmod"+this.attr("id"),"class":"FormElement ui-jqdialog-content"}).append(h).dialog({autoOpen:!0,modal:!1,minWidth:350,appendTo:$(".ui-tabs-panel[aria-expanded='true']").children(".tab_main_content"),title:$.jgrid.view.caption,closeOnEscape:f.closeOnEscape,resizable:f.resize,width:a+300,buttons:[{text:$.jgrid.view.bClose,click:function(){$(this).dialog("close")}}],close:function(){$(this).parent().parent().children(".ui-widget-overlay").remove();
$(this).dialog("close");$(this).dialog("destroy").remove()},open:function(){var a=$(this).parent();a.children(".ui-dialog-buttonpane").find('button:contains("'+$.jgrid.view.bClose+'")').button({icons:{primary:"ui-icon-close"}}).prop("id","btn_c_"+m);$($("<div />").attr({"class":"ui-widget-overlay ui-front dialog_jqgrid_overlay ui-corner-all",style:"position:absolute;z-index:99"})).prependTo(a.parent());redraw_document()}})},delGridRow:function(k,f){f=$.extend(!0,{resize:!0,mtype:"POST"},$.jgrid.del,
f||{});var a=this,e=a.attr("id");$.isArray(k)&&(k=k.join(","));$("<div>").attr({id:"dialog_delmod"+a.attr("id"),"class":"FormElement ui-jqdialog-content"}).append($.jgrid.del.msg).dialog({autoOpen:!0,modal:!1,minWidth:350,appendTo:$(".ui-tabs-panel[aria-expanded='true']").children(".tab_main_content"),title:$.jgrid.del.caption,closeOnEscape:f.closeOnEscape,resizable:f.resize,buttons:[{text:$.jgrid.del.bSubmit,click:function(){var l=$(this);$("#btn_d_"+e).button("option","disabled",!0);$("#btn_c_"+
e).button("option","disabled",!0);var m={};m.id=k;m.oper="del";$.ajax({url:a.jqGrid("getGridParam","editurl"),datatype:"json",data:m,cache:!1,type:f.mtype,success:function(f,h){$.each(k.split(","),function(e,f){a.jqGrid("delRowData",f)});l.dialog("close");$("#btn_d_"+e).button("option","disabled",!1);$("#btn_c_"+e).button("option","disabled",!1)}})}},{text:$.jgrid.del.bCancel,click:function(){$(this).dialog("close")}}],close:function(){$(this).parent().parent().children(".ui-widget-overlay").remove();
$(this).dialog("close");$(this).dialog("destroy").remove()},open:function(){var a=$(this).parent();a.children(".ui-dialog-buttonpane").find('button:contains("'+$.jgrid.del.bCancel+'")').button({icons:{primary:"ui-icon-close"}}).prop("id","btn_c_"+e);a.children(".ui-dialog-buttonpane").find('button:contains("'+$.jgrid.del.bSubmit+'")').button({icons:{primary:"ui-icon-trash"}}).prop("id","btn_d_"+e);$($("<div />").attr({"class":"ui-widget-overlay ui-front dialog_jqgrid_overlay ui-corner-all",style:"position:absolute;z-index:99"})).prependTo(a.parent());
redraw_document()}})},columnChooser:function(k){var f=this;if(!$("#colchooser_"+$.jgrid.jqID(f[0].p.id)).length){var a=f.jqGrid("getGridParam","colModel"),e=f.jqGrid("getGridParam","colNames"),l=$("<div />").attr({id:"colchooser_"+f[0].p.id,style:"position:relative;overflow-y:enable"}),m=$("<ol />").attr({style:"list-style-type: none; margin: 0; padding: 0; width: 100%;"});m.bind("mousedown",function(a){a.metaKey=!0}).selectable({selected:function(a,e){$(e.selected).addClass("ui-state-active")},unselected:function(a,
e){$(e.unselected).removeClass("ui-state-active")}});$.each(a,function(a){this.hidedlg||(a=$("<li />").attr({value:a,"class":"ui-widget-content ui-state-default",style:"margin: 3px; padding: 0.4em; font-size: 0.8em; height: 12px; text-align:left; cursor:pointer;"}).text(e[a].replace("<br>"," ").replace("<BR>"," ")),this.hidden||a.addClass("ui-state-active").addClass("ui-selected"),m.append(a))});l.append(m).dialog({autoOpen:!0,modal:!1,appendTo:$(".ui-tabs-panel[aria-expanded='true']").children(".tab_main_content"),
title:$.jgrid.col.caption,width:k.width,height:k.height,resizable:!0,buttons:[{text:$.jgrid.col.bSubmit,click:function(){$.each(m.find("li"),function(e,k){var g=$(this).val();$(this).hasClass("ui-selected")?f.jqGrid("showCol",a[g].name):f.jqGrid("hideCol",a[g].name)});$(this).dialog("close")}},{text:$.jgrid.col.bCancel,click:function(){$(this).dialog("close")}}],close:function(){$(this).parent().parent().children(".ui-widget-overlay").remove();$(this).dialog("close");$(this).dialog("destroy").remove();
redraw_document()},open:function(){var a=$(this).parent();a.children(".ui-dialog-buttonpane").find('button:contains("'+$.jgrid.col.bCancel+'")').button({icons:{primary:"ui-icon-close"}});a.children(".ui-dialog-buttonpane").find('button:contains("'+$.jgrid.col.bSubmit+'")').button({icons:{primary:"ui-icon-disk"}});$($("<div />").attr({"class":"ui-widget-overlay ui-front dialog_jqgrid_overlay ui-corner-all",style:"position:absolute;z-index:99"})).prependTo(a.parent());redraw_document()}})}},filterToolbar:function(k){k=
$.extend({autosearch:!0,searchOnEnter:!0,beforeSearch:null,afterSearch:null,beforeClear:null,afterClear:null,searchurl:"",stringResult:!1,groupOp:"AND",defaultSearch:"bw"},k||{});return this.each(function(){function f(a,c){var e=$(a);e[0]&&jQuery.each(c,function(){void 0!==this.data?e.bind(this.type,this.data,this.fn):e.bind(this.type,this.fn)})}var a=this,e=$(this).parent().parent().parent().prop("id"),l=!1;if(!this.ftoolbar){var m=function(){var b={},c=0,f,d,h={},g;$.each(a.p.colModel,function(){d=
this.index||this.name;g=this.searchoptions&&this.searchoptions.sopt?this.searchoptions.sopt[0]:"select"==this.stype?"eq":k.defaultSearch;f=$("#gs_"+e+"_"+$.jgrid.jqID(this.name),!0===this.frozen&&!0===a.p.frozenColumns?a.grid.fhDiv:a.grid.hDiv).val();l=!0;if(f)" ui-icon  ui-icon-close"==$("#search_"+e+"_"+$.jgrid.jqID(this.name)).prop("class")&&$("#search_"+e+"_"+$.jgrid.jqID(this.name)).attr({"class":" ui-icon  ui-icon-radio-off",title:"\u0432\u0445\u043e\u0434\u0438\u0442",value:"LIKE"}),b[d]=$("#search_"+
e+"_"+$.jgrid.jqID(this.name)).attr("value")+">"+$("#gs_"+e+"_"+$.jgrid.jqID(this.name)).prop("value"),h[d]=g,c++;else try{delete a.p.postData[d]}catch(v){}});var m=0<c?!0:!1;if(!0===k.stringResult||"local"==a.p.datatype){var n='{"groupOp":"'+k.groupOp+'","rules":[',r=0;$.each(b,function(a,b){0<r&&(n+=",");n+='{"field":"'+a+'",';n+='"op":"'+h[a]+'",';n+='"data":"'+(b+"").replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}';r++});n+="]}";$.extend(a.p.postData,{filters:n});$.each(["searchField","searchString",
"searchOper"],function(b,c){a.p.postData.hasOwnProperty(c)&&delete a.p.postData[c]})}else $.extend(a.p.postData,b);var t;a.p.searchurl&&(t=a.p.url,$(a).jqGrid("setGridParam",{url:a.p.searchurl}));var v="stop"===$(a).triggerHandler("jqGridToolbarBeforeSearch")?!0:!1;!v&&$.isFunction(k.beforeSearch)&&(v=k.beforeSearch.call(a));v||$(a).jqGrid("setGridParam",{search:m}).trigger("reloadGrid",[{page:1}]);t&&$(a).jqGrid("setGridParam",{url:t});$(a).triggerHandler("jqGridToolbarAfterSearch");$.isFunction(k.afterSearch)&&
k.afterSearch.call(a)},p=function(b){var c={},f=0,d;b="boolean"!=typeof b?!0:b;$.each(a.p.colModel,function(){var b;this.searchoptions&&void 0!==this.searchoptions.defaultValue&&(b=this.searchoptions.defaultValue);d=this.index||this.name;$("#search_"+e+"_"+$.jgrid.jqID(this.name)).prop({"class":" ui-icon  ui-icon-close",title:"\u041d\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f",value:"NONE"});$("#gs_"+e+"_"+$.jgrid.jqID(this.name)).prop({value:""});switch(this.stype){case "select":$("#gs_"+
$.jgrid.jqID(this.name)+" option",!0===this.frozen&&!0===a.p.frozenColumns?a.grid.fhDiv:a.grid.hDiv).each(function(a){0===a&&(this.selected=!0);if($(this).val()==b)return this.selected=!0,!1});if(void 0!==b)c[d]=b,f++;else try{delete a.p.postData[d]}catch(g){}break;case "text":if($("#gs_"+$.jgrid.jqID(this.name),!0===this.frozen&&!0===a.p.frozenColumns?a.grid.fhDiv:a.grid.hDiv).val(b),void 0!==b)c[d]=b,f++;else try{delete a.p.postData[d]}catch(h){}}});var h=0<f?!0:!1;if(!0===k.stringResult||"local"==
a.p.datatype){var g='{"groupOp":"'+k.groupOp+'","rules":[',m=0;$.each(c,function(a,b){0<m&&(g+=",");g+='{"field":"'+a+'",';g+='"op":"eq",';g+='"data":"'+(b+"").replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}';m++});g+="]}";$.extend(a.p.postData,{filters:g});$.each(["searchField","searchString","searchOper"],function(b,c){a.p.postData.hasOwnProperty(c)&&delete a.p.postData[c]})}else $.extend(a.p.postData,c);var n;a.p.searchurl&&(n=a.p.url,$(a).jqGrid("setGridParam",{url:a.p.searchurl}));var l="stop"===
$(a).triggerHandler("jqGridToolbarBeforeClear")?!0:!1;!l&&$.isFunction(k.beforeClear)&&(l=k.beforeClear.call(a));l||b&&$(a).jqGrid("setGridParam",{search:h}).trigger("reloadGrid",[{page:1}]);n&&$(a).jqGrid("setGridParam",{url:n});$(a).triggerHandler("jqGridToolbarAfterClear");$.isFunction(k.afterClear)&&k.afterClear()},h=function(){var b=$("tr.ui-search-toolbar",a.grid.hDiv),c=!0===a.p.frozenColumns?$("tr.ui-search-toolbar",a.grid.fhDiv):!1;"none"==b.css("display")?(b.show(),$("#"+e).children(".ui-jqgrid-bdiv").height($("#"+
e).children(".ui-jqgrid-bdiv").height()-27),l=!1,c&&c.show()):(b.hide(),$("#"+e).children(".ui-jqgrid-bdiv").height($("#"+e).children(".ui-jqgrid-bdiv").height()+27),l&&p(),c&&c.hide())},g=$("<tr class='ui-search-toolbar' role='rowheader'></tr>"),s;$.each(a.p.colModel,function(){var b=this,c,h,d,l;h=$("<th role='columnheader' class='ui-state-default ui-th-column ui-th-"+a.p.direction+"'></th>");c=$("<div style='text-align:left;position:relative;vertical-align:middle'></div>");!0===this.hidden&&$(h).css("display",
"none");this.search=!1===this.search?!1:!0;"undefined"==typeof b.formatter&&(b.formatter="text");d=$.extend({},this.searchoptions||{});if(this.search)switch(b.formatter){case "select":if(l=this.surl||d.dataUrl)$.ajax($.extend({url:l,dataType:"html",success:function(a){void 0!==d.buildSelect?(a=d.buildSelect(a))&&$(c).append(a):$(c).append(a);void 0!==d.defaultValue&&$("select",c).val(d.defaultValue);$("select",c).prop({name:b.index||b.name,id:"gs_"+e+"_"+b.name});$("select",c).css("float","left").css("padding-left",
"15px");$("select",c).prop("class","ui-state-default");d.prop&&$("select",c).prop(d.prop);$("select",c).css({width:"100%"});void 0!==d.dataInit&&d.dataInit($("select",c)[0]);void 0!==d.dataEvents&&f($("select",c)[0],d.dataEvents);!0===k.autosearch&&$("select",c).change(function(){m();return!1});a=null}},$.jgrid.ajaxOptions,a.p.ajaxSelectOptions||{}));else{var p,q,n;b.searchoptions?(p=void 0===b.searchoptions.value?"":b.searchoptions.value,q=void 0===b.searchoptions.separator?":":b.searchoptions.separator,
n=void 0===b.searchoptions.delimiter?";":b.searchoptions.delimiter):b.editoptions&&(p=void 0===b.editoptions.value?"":b.editoptions.value,q=void 0===b.editoptions.separator?":":b.editoptions.separator,n=void 0===b.editoptions.delimiter?";":b.editoptions.delimiter);if(p){l=document.createElement("select");l.style.width="100%";$(l).prop({name:b.index||b.name,id:"gs_"+e+"_"+b.name});var r;if("string"===typeof p){p=p.split(n);for(var t=0;t<p.length;t++)r=p[t].split(q),n=document.createElement("option"),
n.value=r[0],n.innerHTML=r[1],l.appendChild(n)}else if("object"===typeof p)for(r in p)p.hasOwnProperty(r)&&(n=document.createElement("option"),n.value=r,n.innerHTML=p[r],l.appendChild(n));void 0!==d.defaultValue&&$(l).val(d.defaultValue);d.prop&&$(l).prop(d.prop);void 0!==d.dataInit&&d.dataInit(l);void 0!==d.dataEvents&&f(l,d.dataEvents);$(c).append(l);replace_select_opt_group($(c));1<$(c).find("option:empty").length&&$(c).find("option:empty:first").remove();$(c).children("select").multiselect({multiple:void 0===
b.editoptions.multiple?!1:b.editoptions.multiple,minWidth:b.width,header:!1,selectedList:void 0===b.editoptions.size?1:b.editoptions.size}).css("padding","0.3em");!0===k.autosearch&&$(l).change(function(){m();return!1})}}break;case "checkbox":q=void 0!==d.defaultValue?d.defaultValue:"";$(c).append("<input type='checkbox' class='ui-widget ui-widget-content ui-corner-all' name='"+(b.index||b.name)+"' id='gs_"+e+"_"+b.name+"' value=''/>");$(c).css("text-align","center");$(c).children("input").before("<label for='gs_"+
e+"_"+b.name+"'>\u0412\u043a\u043b\u044e\u0447\u0435\u043d\u043e \u0438\u043b\u0438 \u0432\u044b\u043a\u043b\u044e\u0447\u0435\u043d\u043e</label>").button({icons:{primary:"ui-icon-check"},text:!1});d.prop&&$("input",c).prop(d.prop);void 0!==d.dataInit&&d.dataInit($("input",c)[0]);void 0!==d.dataEvents&&f($("input",c)[0],d.dataEvents);!0===k.autosearch&&$("input",c).click(function(){"1"==$("input",c).prop("value")?$("input",c).prop({value:"0"}):$("input",c).prop({value:"1"});m()});break;case "date":q=
void 0!==d.defaultValue?d.defaultValue:"";$(c).append("<input type='text' style='width:95%;padding-left:15px;' class='FormElement ui-widget ui-widget-content ui-corner-all' name='"+(b.index||b.name)+"' id='gs_"+e+"_"+b.name+"' value='"+q+"'/>");d.prop&&$("input",c).prop(d.prop);void 0!==d.dataInit&&d.dataInit($("input",c)[0]);void 0!==d.dataEvents&&f($("input",c)[0],d.dataEvents);$("input",c).datetimepicker({changeYear:!0,firstDay:1,timeFormat:"HH:mm:ss"});!0===k.autosearch&&(k.searchOnEnter?$("input",
c).keypress(function(a){return 13==(a.charCode?a.charCode:a.keyCode?a.keyCode:0)?(m(),!1):this}):$("input",c).keydown(function(a){switch(a.which){case 13:return!1;case 9:case 16:case 37:case 38:case 39:case 40:case 27:break;default:s&&clearTimeout(s),s=setTimeout(function(){m()},500)}}));break;case "number":q=void 0!==d.defaultValue?d.defaultValue:"";$(c).append("<input type='text' class='FormElement' name='"+(b.index||b.name)+"' id='gs_"+e+"_"+b.name+"' style='float:left;width:93%;' value='"+q+"'/>");
$(c).children("input").spinner({numberFormat:"n2",culture:"ru-RU",step:1}).css({width:"95%","padding-left":"15px"});d.prop&&$("input",c).prop(d.prop);void 0!==d.dataInit&&d.dataInit($("input",c)[0]);void 0!==d.dataEvents&&f($("input",c)[0],d.dataEvents);!0===k.autosearch&&(k.searchOnEnter?$("input",c).keypress(function(a){return 13==(a.charCode?a.charCode:a.keyCode?a.keyCode:0)?(m(),!1):this}):$("input",c).keydown(function(a){switch(a.which){case 13:return!1;case 9:case 16:case 37:case 38:case 39:case 40:case 27:break;
default:s&&clearTimeout(s),s=setTimeout(function(){m()},500)}}));break;default:q=void 0!==d.defaultValue?d.defaultValue:"",$(c).append("<input type='text' style='width:95%;padding-left:15px;' class='FormElement ui-widget ui-widget-content ui-corner-all' name='"+(b.index||b.name)+"' id='gs_"+e+"_"+b.name+"' value='"+q+"'/>"),d.prop&&$("input",c).prop(d.prop),void 0!==d.dataInit&&d.dataInit($("input",c)[0]),void 0!==d.dataEvents&&f($("input",c)[0],d.dataEvents),!0===k.autosearch&&(k.searchOnEnter?$("input",
c).keypress(function(a){return 13==(a.charCode?a.charCode:a.keyCode?a.keyCode:0)?(m(),!1):this}):$("input",c).keydown(function(a){switch(a.which){case 13:return!1;case 9:case 16:case 37:case 38:case 39:case 40:case 27:break;default:s&&clearTimeout(s),s=setTimeout(function(){m()},500)}}))}"rn"!==b.name&&"checkbox"!==b.formatter&&"select"!==b.formatter&&(c.append($("<span />").attr({"class":" ui-icon  ui-icon-close",id:"search_"+e+"_"+b.name,style:"float:left;top:3px;position: absolute; cursor: pointer;",
title:"\u041d\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f",value:"NONE"})),$("span.ui-icon",c).click(function(){" ui-icon  ui-icon-close"==$(this).prop("class")?$(this).attr({"class":" ui-icon  ui-icon-notice",title:"\u041d\u0435\u0440\u0430\u0432\u043d\u043e",value:"NOT"}):" ui-icon  ui-icon-notice"==$(this).prop("class")?$(this).attr({"class":" ui-icon  ui-icon-carat-1-e",title:"\u0411\u043e\u043b\u044c\u0448\u0435",value:"MORE"}):" ui-icon  ui-icon-carat-1-e"==
$(this).prop("class")?$(this).attr({"class":" ui-icon  ui-icon-carat-1-w",title:"\u041c\u0435\u043d\u044c\u0448\u0435",value:"MINI"}):" ui-icon  ui-icon-carat-1-w"==$(this).prop("class")?$(this).attr({"class":" ui-icon  ui-icon-grip-solid-horizontal",title:"\u0420\u0430\u0432\u043d\u043e",value:"EQUAL"}):" ui-icon  ui-icon-grip-solid-horizontal"==$(this).prop("class")?$(this).attr({"class":" ui-icon  ui-icon-radio-off",title:"\u0432\u0445\u043e\u0434\u0438\u0442",value:"LIKE"}):" ui-icon  ui-icon-radio-off"==
$(this).prop("class")&&$(this).attr({"class":" ui-icon  ui-icon-close",title:"\u041d\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f",value:"NONE"})}));$(h).append(c);$(g).append(h)});$("table thead",a.grid.hDiv).append(g);this.ftoolbar=!0;this.triggerToolbar=m;this.clearToolbar=p;this.toggleToolbar=h;h()}})}});