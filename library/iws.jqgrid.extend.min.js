/*
* Autor Andrey Lysikov (C) 2014
* Licensed under the MIT license:
*   http://www.opensource.org/licenses/mit-license.php
* Part of IWS system
* 
*/
$.jgrid.extend({editGridRow:function(d,g){g=$.extend(!0,{modal:!0,resize:!0,mtype:"POST",addedrow:"last",reloadAfterSubmit:!0,beforeSubmit:null,afterSubmit:null,recreateForm:!1,closeOnEscape:!1,serializeEditData:null},$.jgrid.edit,g||{});var a=this;CreateEditDialog=function(f){var h=a.jqGrid("getGridParam","colModel"),t=a.jqGrid("getGridParam","colNames"),k=a.jqGrid("getGridParam","treeGrid"),b=a.attr("id"),e=$("<form />").attr({name:"FormPost",id:"editmod"+b,onsubmit:"return false;",style:"text-align: left;"}),
u=$("<table />").attr({id:"TblGrid_"+b,"class":"EditTable",cellspacing:"0",cellpadding:"0",border:"0"});$("#dialog_editmod"+b).dialog("destroy").remove();$(h).each(function(b){if("undefined"!==typeof h[b].editoptions){var a="",e="";$.each(h[b].editoptions,function(b,a){"value"!==b&&(e=e+b+'="'+a+'" ')});h[b].editable||(h[b].hidden_tmp=!0);h[b].hidden&&(h[b].hidden_tmp=!0);h[b].edittype||(h[b].edittype="text");switch(h[b].edittype){case "text":a='<input class="FormElement ui-widget-content ui-corner-all" id="'+
h[b].index+'" name="'+h[b].index+'" type="text" '+e+' value="'+f[h[b].index]+'" />';break;case "checkbox":"1"===f[h[b].index]&&(e+='checked="checked"');a='<input class="FormElement ui-widget-content ui-corner-all" id="'+h[b].index+'" name="'+h[b].index+'" type="checkbox" '+e+" />";break;case "password":a='<input class="FormElement ui-widget-content ui-corner-all" id="'+h[b].index+'" name="'+h[b].index+'" type="password" '+e+' value="" />';break;case "textarea":a='<textarea class="FormElement ui-widget-content ui-corner-all" id="'+
h[b].index+'" '+e+' name="'+h[b].index+'" >'+f[h[b].index]+"</textarea>";break;case "select":a='<select class="FormElement ui-widget-content ui-corner-all" id="'+h[b].index+'" '+e+' name="'+h[b].index+'"  >',$.each(h[b].editoptions.value.split(";"),function(e,c){sel="";el=c.split(":");h[b].editoptions.multiple?val=f[h[b].index].split(","):"undefined"!==typeof f[h[b].index]&&(val=f[h[b].index].split("~|"));$.each(val,function(b,a){$.trim(a)===$.trim(el[0])&&(sel="selected")});a=a+'<option value="'+
el[0]+'" '+sel+">"+el[1]+"</option>"}),a+="</select>"}h[b].editoptions.title||(h[b].editoptions.title="");table_elements=$("<tr />").attr({id:"tr_"+h[b].index,"class":"FormData",title:h[b].editoptions.title,style:h[b].hidden_tmp?"display:none":""});table_elements.append($("<td />").attr({"class":"CaptionTD",style:"width:150px;"}).append(t[b]));table_elements.append($("<td />").attr({"class":"DataTD"}).append(a));u.append(table_elements)}});if($.isFunction(create_from_table_elements)){$.isFunction(replace_select_opt_group)&&
replace_select_opt_group(u);var c=create_from_table_elements(u)+200+60}else c=710;e.append(u);e.append('<input type="hidden" name="id" value="'+d+'"><input type="hidden" name="oper" value="edit">');bSubmit=$.jgrid.edit.bSubmit;bCancel=$.jgrid.edit.bCancel;$("<div>").attr({id:"dialog_editmod"+a.attr("id"),"class":"FormElement ui-jqdialog-content"}).append(e).dialog({autoOpen:!1,modal:!1,minWidth:450,width:c,appendTo:$(".ui-tabs-panel[aria-expanded='true']").children(".tab_main_content"),closeOnEscape:g.closeOnEscape,
resizable:g.resize,buttons:[{text:bSubmit,click:function(){var e=$(this),c=[];$.each($("#editmod"+b).find("input, select, textarea"),function(){var b=$(this);a.attr("for_object_db");void 0!==b.attr("name")&&("B"===b.attr("row_type")?c[b.attr("name")]="checked"===b.attr("checked")?1:0:c[b.attr("name")]=b.val())});c=$.extend({},c);"new"===c.id&&(c.oper="add",k&&(c.ID_PARENT=a.jqGrid("getGridParam","selrow")));var f=!0;$.isFunction(g.serializeEditData)&&(c=g.serializeEditData.call(g,c));$.isFunction(g.beforeSubmit)&&
(ret=g.beforeSubmit.call(g,c,$("#editmod"+b)),f="undefined"!==typeof ret?ret[0]:!1);f&&($("#btn_s_"+b).button("option","disabled",!0),$("#btn_c_"+b).button("option","disabled",!0),$.ajax({url:a.jqGrid("getGridParam","editurl"),datatype:"json",data:c,cache:!1,type:g.mtype,success:function(h,t){f=!0;var d={};d.statusText=t;d.responseText=h;$.isFunction(g.afterSubmit)&&(ret=g.afterSubmit.call(g,d,c,b),f="undefined"!==typeof ret?ret[0]:!1);f&&("add"!==c.oper?(delete c.oper,a.jqGrid("setRowData",c.id,
c)):(delete c.oper,delete c.id,d=[],d[$("#editmod"+b).find("input[index_field='true']").attr("id")]=ret[2],c=$.extend(c,d),k?a.jqGrid("addChildNode",ret[2],c.ID_PARENT,c):a.jqGrid("addRowData",ret[2],c,g.addedrow)),e.dialog("close"));$("#btn_s_"+b).button("option","disabled",!1);$("#btn_c_"+b).button("option","disabled",!1)}}))}},{text:bCancel,click:function(){$(this).dialog("close")}}],close:function(){$(this).parent().parent().children(".ui-widget-overlay").remove();$(this).dialog("close")},open:function(){var a=
$(this).parent();a.children(".ui-dialog-buttonpane").find('button:contains("'+bCancel+'")').button({icons:{primary:"ui-icon-close"}}).prop("id","btn_c_"+b);a.children(".ui-dialog-buttonpane").find('button:contains("'+bSubmit+'")').button({icons:{primary:"ui-icon-disk"}}).prop("id","btn_s_"+b);$($("<div />").attr({"class":"ui-widget-overlay ui-front dialog_jqgrid_overlay ui-corner-all",style:"position:absolute;z-index:99"})).prependTo(a.parent());redraw_document()}})};var f=$("#editmod"+a.attr("id"));
if("new"!==d)var l=a.jqGrid("getRowData",d);else{var l=[],k=a.jqGrid("getGridParam","colModel");$(k).each(function(a){"undefined"!==typeof k[a].editoptions&&(l[k[a].index]="")});l=$.extend({},l)}g.recreateForm||0===f.length?CreateEditDialog(l):(f=$("#editmod"+a.attr("id")),$.each(l,function(a,f){var d=$("#"+a);"SB"===d.attr("row_type")?(d.children("option").removeAttr("selected"),f=d.attr("multiple")?f.split(","):f.split("~|"),$.each(f,function(a,b){d.find("option[value='"+$.trim(b)+"']").attr("selected",
"")})):"B"===d.attr("row_type")?"1"===f?d.attr({checked:"checked"}):d.removeAttr("checked"):d.val(f)}),$.isFunction(replace_select_opt_group)&&replace_select_opt_group(f),$.isFunction(update_table_elemnts)&&update_table_elemnts(f));f.find('input[name="oper"]').val("edit");f.find('input[name="id"]').val(d);$("#dialog_editmod"+a.attr("id")).dialog("option","title",g.editCaption).dialog("open")},viewGridRow:function(d,g){g=$.extend(!0,{modal:!1,resize:!0,closeOnEscape:!1,viewPagerButtons:!0},$.jgrid.view,
g||{});var a=0,f=this.jqGrid("getGridParam","colModel"),l=this.jqGrid("getGridParam","colNames"),k=this.attr("id"),p=this.jqGrid("getRowData",d),h=$("<table />").attr({id:"TblGrid_"+k,"class":"EditTable",cellspacing:"0",cellpadding:"0",border:"0"});$(f).each(function(d){if("undefined"!==typeof f[d].editoptions){f[d].edittype||(f[d].edittype="text");f[d].editable||(f[d].hidden=!0);var g="disabled ";$.each(f[d].editoptions,function(b,e){"value"!==b&&("w"===b&&(parseInt(e)>a&&(a=parseInt(e)),b="style",
e="width:"+e+"px;"),g=g+b+'="'+e+'" ')});switch(f[d].edittype){case "text":elem='<input class="FormElement ui-widget-content ui-corner-all"  type="text" '+g+' value="'+p[f[d].index]+'" />';break;case "checkbox":"1"===p[f[d].index]&&(g+='checked="checked"');elem='<input class="FormElement ui-widget-content ui-corner-all" type="checkbox" '+g+" />";break;case "password":elem='<input class="FormElement ui-widget-content ui-corner-all" type="password" '+g+' value="" />';break;case "textarea":elem='<textarea class="FormElement ui-widget-content ui-corner-all" '+
g+">"+p[f[d].index]+"</textarea>";break;case "select":case "select":elem='<select class="FormElement ui-widget-content ui-corner-all"  '+g+"  >",$.each(f[d].editoptions.value.split(";"),function(b,a){sel="";el=a.split(":");val=f[d].editoptions.multiple?p[f[d].index].split(","):p[f[d].index].split("~|");$.each(val,function(b,a){$.trim(a)===$.trim(el[0])&&(sel="selected")});elem=elem+'<option value="'+el[0]+'" '+sel+">"+el[1]+"</option>"}),elem+="</select>"}f[d].editoptions.title||(f[d].editoptions.title=
"");table_elements=$("<tr />").attr({id:"tr_"+f[d].index,"class":"FormData",title:f[d].editoptions.title,style:f[d].hidden?"display:none":""});table_elements.append($("<td />").attr({"class":"CaptionTD",style:"width:150px;text-align:left;padding:5px;"}).append("<b>"+l[d]+"</b>"));table_elements.append($("<td />").attr({"class":"DataTD",style:"text-align:left;padding:5px;"}).append(elem));h.append(table_elements)}});$("<div>").attr({id:"dialog_viewmod"+this.attr("id"),"class":"FormElement ui-jqdialog-content"}).append(h).dialog({autoOpen:!0,
modal:!1,minWidth:350,appendTo:$(".ui-tabs-panel[aria-expanded='true']").children(".tab_main_content"),title:$.jgrid.view.caption,closeOnEscape:g.closeOnEscape,resizable:g.resize,width:a+300,buttons:[{text:$.jgrid.view.bClose,click:function(){$(this).dialog("close")}}],close:function(){$(this).parent().parent().children(".ui-widget-overlay").remove();$(this).dialog("close");$(this).dialog("destroy").remove()},open:function(){var a=$(this).parent();a.children(".ui-dialog-buttonpane").find('button:contains("'+
$.jgrid.view.bClose+'")').button({icons:{primary:"ui-icon-close"}}).prop("id","btn_c_"+k);$($("<div />").attr({"class":"ui-widget-overlay ui-front dialog_jqgrid_overlay ui-corner-all",style:"position:absolute;z-index:99"})).prependTo(a.parent());redraw_document()}})},delGridRow:function(d,g){g=$.extend(!0,{resize:!0,mtype:"POST"},$.jgrid.del,g||{});var a=this,f=a.attr("id");$.isArray(d)&&(d=d.join(","));$("<div>").attr({id:"dialog_delmod"+a.attr("id"),"class":"FormElement ui-jqdialog-content"}).append($.jgrid.del.msg).dialog({autoOpen:!0,
modal:!1,minWidth:350,appendTo:$(".ui-tabs-panel[aria-expanded='true']").children(".tab_main_content"),title:$.jgrid.del.caption,closeOnEscape:g.closeOnEscape,resizable:g.resize,buttons:[{text:$.jgrid.del.bSubmit,click:function(){var l=$(this);$("#btn_d_"+f).button("option","disabled",!0);$("#btn_c_"+f).button("option","disabled",!0);var k={};k.id=d;k.oper="del";$.ajax({url:a.jqGrid("getGridParam","editurl"),datatype:"json",data:k,cache:!1,type:g.mtype,success:function(g,h){$.each(d.split(","),function(d,
f){a.jqGrid("delRowData",f)});l.dialog("close");$("#btn_d_"+f).button("option","disabled",!1);$("#btn_c_"+f).button("option","disabled",!1)}})}},{text:$.jgrid.del.bCancel,click:function(){$(this).dialog("close")}}],close:function(){$(this).parent().parent().children(".ui-widget-overlay").remove();$(this).dialog("close");$(this).dialog("destroy").remove()},open:function(){var a=$(this).parent();a.children(".ui-dialog-buttonpane").find('button:contains("'+$.jgrid.del.bCancel+'")').button({icons:{primary:"ui-icon-close"}}).prop("id",
"btn_c_"+f);a.children(".ui-dialog-buttonpane").find('button:contains("'+$.jgrid.del.bSubmit+'")').button({icons:{primary:"ui-icon-trash"}}).prop("id","btn_d_"+f);$($("<div />").attr({"class":"ui-widget-overlay ui-front dialog_jqgrid_overlay ui-corner-all",style:"position:absolute;z-index:99"})).prependTo(a.parent());redraw_document()}})},columnChooser:function(d){var g=this;if(!$("#colchooser_"+$.jgrid.jqID(g[0].p.id)).length){var a=g.jqGrid("getGridParam","colModel"),f=g.jqGrid("getGridParam","colNames"),
l=$("<div />").attr({id:"colchooser_"+g[0].p.id,style:"position:relative;overflow-y:enable"}),k=$("<ol />").attr({style:"list-style-type: none; margin: 0; padding: 0; width: 100%;"});k.bind("mousedown",function(a){a.metaKey=!0}).selectable({selected:function(a,d){$(d.selected).addClass("ui-state-active")},unselected:function(a,d){$(d.unselected).removeClass("ui-state-active")}});$.each(a,function(a){this.hidedlg||(a=$("<li />").attr({value:a,"class":"ui-widget-content ui-state-default",style:"margin: 3px; padding: 0.4em; font-size: 0.8em; height: 12px; text-align:left; cursor:pointer;"}).html(f[a].replace("<br>",
" ").replace("<BR>"," ")),this.hidden||a.addClass("ui-state-active").addClass("ui-selected"),k.append(a))});l.append(k).dialog({autoOpen:!0,modal:!1,appendTo:$(".ui-tabs-panel[aria-expanded='true']").children(".tab_main_content"),title:$.jgrid.col.caption,width:d.width,height:d.height,resizable:!0,buttons:[{text:$.jgrid.col.bSubmit,click:function(){$.each(k.find("li"),function(d,f){var k=$(this).val();$(this).hasClass("ui-selected")?g.jqGrid("showCol",a[k].name):g.jqGrid("hideCol",a[k].name)});$(this).dialog("close")}},
{text:$.jgrid.col.bCancel,click:function(){$(this).dialog("close")}}],close:function(){$(this).parent().parent().children(".ui-widget-overlay").remove();$(this).dialog("close");$(this).dialog("destroy").remove();redraw_document()},open:function(){var a=$(this).parent();a.children(".ui-dialog-buttonpane").find('button:contains("'+$.jgrid.col.bCancel+'")').button({icons:{primary:"ui-icon-close"}});a.children(".ui-dialog-buttonpane").find('button:contains("'+$.jgrid.col.bSubmit+'")').button({icons:{primary:"ui-icon-disk"}});
$($("<div />").attr({"class":"ui-widget-overlay ui-front dialog_jqgrid_overlay ui-corner-all",style:"position:absolute;z-index:99"})).prependTo(a.parent());redraw_document()}})}},filterToolbar:function(d){d=$.extend({autosearch:!0,searchOnEnter:!0,beforeSearch:null,afterSearch:null,beforeClear:null,afterClear:null,searchurl:"",stringResult:!1,groupOp:"AND",defaultSearch:"bw"},d||{});return this.each(function(){function g(a,e){var d=$(a);d[0]&&jQuery.each(e,function(){void 0!==this.data?d.bind(this.type,
this.data,this.fn):d.bind(this.type,this.fn)})}var a=this,f=$(this).parent().parent().parent().prop("id"),l=!1;if(!this.ftoolbar){var k=function(){var b={},e=0,g,c,h={},k;$.each(a.p.colModel,function(){c=this.index||this.name;k=this.searchoptions&&this.searchoptions.sopt?this.searchoptions.sopt[0]:"select"==this.stype?"eq":d.defaultSearch;g=$("#gs_"+f+"_"+$.jgrid.jqID(this.name),!0===this.frozen&&!0===a.p.frozenColumns?a.grid.fhDiv:a.grid.hDiv).val();l=!0;if(g)" ui-icon  ui-icon-close"==$("#search_"+
f+"_"+$.jgrid.jqID(this.name)).prop("class")&&$("#search_"+f+"_"+$.jgrid.jqID(this.name)).attr({"class":" ui-icon  ui-icon-radio-off",title:"\u0432\u0445\u043e\u0434\u0438\u0442",value:"LIKE"}),b[c]=$("#search_"+f+"_"+$.jgrid.jqID(this.name)).attr("value")+">"+$("#gs_"+f+"_"+$.jgrid.jqID(this.name)).prop("value"),h[c]=k,e++;else try{delete a.p.postData[c]}catch(v){}});var r=0<e?!0:!1;if(!0===d.stringResult||"local"==a.p.datatype){var m='{"groupOp":"'+d.groupOp+'","rules":[',n=0;$.each(b,function(a,
b){0<n&&(m+=",");m+='{"field":"'+a+'",';m+='"op":"'+h[a]+'",';m+='"data":"'+(b+"").replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}';n++});m+="]}";$.extend(a.p.postData,{filters:m});$.each(["searchField","searchString","searchOper"],function(b,c){a.p.postData.hasOwnProperty(c)&&delete a.p.postData[c]})}else $.extend(a.p.postData,b);var w;a.p.searchurl&&(w=a.p.url,$(a).jqGrid("setGridParam",{url:a.p.searchurl}));var v="stop"===$(a).triggerHandler("jqGridToolbarBeforeSearch")?!0:!1;!v&&$.isFunction(d.beforeSearch)&&
(v=d.beforeSearch.call(a));v||$(a).jqGrid("setGridParam",{search:r}).trigger("reloadGrid",[{page:1}]);w&&$(a).jqGrid("setGridParam",{url:w});$(a).triggerHandler("jqGridToolbarAfterSearch");$.isFunction(d.afterSearch)&&d.afterSearch.call(a)},p=function(b){var e={},g=0,c;b="boolean"!=typeof b?!0:b;$.each(a.p.colModel,function(){var b;this.searchoptions&&void 0!==this.searchoptions.defaultValue&&(b=this.searchoptions.defaultValue);c=this.index||this.name;$("#search_"+f+"_"+$.jgrid.jqID(this.name)).prop({"class":" ui-icon  ui-icon-close",
title:"\u041d\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f",value:"NONE"});$("#gs_"+f+"_"+$.jgrid.jqID(this.name)).prop({value:""});switch(this.stype){case "select":$("#gs_"+$.jgrid.jqID(this.name)+" option",!0===this.frozen&&!0===a.p.frozenColumns?a.grid.fhDiv:a.grid.hDiv).each(function(a){0===a&&(this.selected=!0);if($(this).val()==b)return this.selected=!0,!1});if(void 0!==b)e[c]=b,g++;else try{delete a.p.postData[c]}catch(d){}break;case "text":if($("#gs_"+$.jgrid.jqID(this.name),
!0===this.frozen&&!0===a.p.frozenColumns?a.grid.fhDiv:a.grid.hDiv).val(b),void 0!==b)e[c]=b,g++;else try{delete a.p.postData[c]}catch(h){}}});var h=0<g?!0:!1;if(!0===d.stringResult||"local"==a.p.datatype){var k='{"groupOp":"'+d.groupOp+'","rules":[',l=0;$.each(e,function(a,b){0<l&&(k+=",");k+='{"field":"'+a+'",';k+='"op":"eq",';k+='"data":"'+(b+"").replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}';l++});k+="]}";$.extend(a.p.postData,{filters:k});$.each(["searchField","searchString","searchOper"],function(b,
c){a.p.postData.hasOwnProperty(c)&&delete a.p.postData[c]})}else $.extend(a.p.postData,e);var m;a.p.searchurl&&(m=a.p.url,$(a).jqGrid("setGridParam",{url:a.p.searchurl}));var n="stop"===$(a).triggerHandler("jqGridToolbarBeforeClear")?!0:!1;!n&&$.isFunction(d.beforeClear)&&(n=d.beforeClear.call(a));n||b&&$(a).jqGrid("setGridParam",{search:h}).trigger("reloadGrid",[{page:1}]);m&&$(a).jqGrid("setGridParam",{url:m});$(a).triggerHandler("jqGridToolbarAfterClear");$.isFunction(d.afterClear)&&d.afterClear()},
h=function(){var b=$("tr.ui-search-toolbar",a.grid.hDiv),d=!0===a.p.frozenColumns?$("tr.ui-search-toolbar",a.grid.fhDiv):!1;"none"==b.css("display")?(b.show(),$("#"+f).children(".ui-jqgrid-bdiv").height($("#"+f).children(".ui-jqgrid-bdiv").height()-27),l=!1,d&&d.show()):(b.hide(),$("#"+f).children(".ui-jqgrid-bdiv").height($("#"+f).children(".ui-jqgrid-bdiv").height()+27),l&&p(),d&&d.hide())},t=$("<tr class='ui-search-toolbar' role='rowheader'></tr>"),s;$.each(a.p.colModel,function(){var b=this,e,
h,c,l;h=$("<th role='columnheader' class='ui-state-default ui-th-column ui-th-"+a.p.direction+"'></th>");e=$("<div style='text-align:left;position:relative;vertical-align:middle'></div>");!0===this.hidden&&$(h).css("display","none");this.search=!1===this.search?!1:!0;"undefined"==typeof b.formatter&&(b.formatter="text");c=$.extend({},this.searchoptions||{});if(this.search)switch(b.formatter){case "select":if(l=this.surl||c.dataUrl)$.ajax($.extend({url:l,dataType:"html",success:function(a){void 0!==
c.buildSelect?(a=c.buildSelect(a))&&$(e).append(a):$(e).append(a);void 0!==c.defaultValue&&$("select",e).val(c.defaultValue);$("select",e).prop({name:b.index||b.name,id:"gs_"+f+"_"+b.name});$("select",e).css("float","left").css("padding-left","15px");$("select",e).prop("class","ui-state-default");c.prop&&$("select",e).prop(c.prop);$("select",e).css({width:"100%"});void 0!==c.dataInit&&c.dataInit($("select",e)[0]);void 0!==c.dataEvents&&g($("select",e)[0],c.dataEvents);!0===d.autosearch&&$("select",
e).change(function(){k();return!1});a=null}},$.jgrid.ajaxOptions,a.p.ajaxSelectOptions||{}));else{var q,r,m;b.searchoptions?(q=void 0===b.searchoptions.value?"":b.searchoptions.value,r=void 0===b.searchoptions.separator?":":b.searchoptions.separator,m=void 0===b.searchoptions.delimiter?";":b.searchoptions.delimiter):b.editoptions&&(q=void 0===b.editoptions.value?"":b.editoptions.value,r=void 0===b.editoptions.separator?":":b.editoptions.separator,m=void 0===b.editoptions.delimiter?";":b.editoptions.delimiter);
if(q){l=document.createElement("select");l.style.width="100%";$(l).prop({name:b.index||b.name,id:"gs_"+f+"_"+b.name});var n;if("string"===typeof q){q=q.split(m);for(var p=0;p<q.length;p++)n=q[p].split(r),m=document.createElement("option"),m.value=n[0],m.innerHTML=n[1],l.appendChild(m)}else if("object"===typeof q)for(n in q)q.hasOwnProperty(n)&&(m=document.createElement("option"),m.value=n,m.innerHTML=q[n],l.appendChild(m));void 0!==c.defaultValue&&$(l).val(c.defaultValue);c.prop&&$(l).prop(c.prop);
void 0!==c.dataInit&&c.dataInit(l);void 0!==c.dataEvents&&g(l,c.dataEvents);$(e).append(l);replace_select_opt_group($(e));1<$(e).find("option:empty").length&&$(e).find("option:empty:first").remove();$(e).children("select").multiselect({multiple:void 0===b.editoptions.multiple?!1:b.editoptions.multiple,minWidth:b.width,header:!1,selectedList:void 0===b.editoptions.size?1:b.editoptions.size}).css("padding","0.3em");!0===d.autosearch&&$(l).change(function(){k();return!1})}}break;case "checkbox":r=void 0!==
c.defaultValue?c.defaultValue:"";$(e).append("<input type='checkbox' class='ui-widget ui-widget-content ui-corner-all' name='"+(b.index||b.name)+"' id='gs_"+f+"_"+b.name+"' value=''/>");$(e).css("text-align","center");$(e).children("input").before("<label for='gs_"+f+"_"+b.name+"'>\u0412\u043a\u043b\u044e\u0447\u0435\u043d\u043e \u0438\u043b\u0438 \u0432\u044b\u043a\u043b\u044e\u0447\u0435\u043d\u043e</label>").button({icons:{primary:"ui-icon-check"},text:!1});c.prop&&$("input",e).prop(c.prop);void 0!==
c.dataInit&&c.dataInit($("input",e)[0]);void 0!==c.dataEvents&&g($("input",e)[0],c.dataEvents);!0===d.autosearch&&$("input",e).click(function(){"1"==$("input",e).prop("value")?$("input",e).prop({value:"0"}):$("input",e).prop({value:"1"});k()});break;case "date":r=void 0!==c.defaultValue?c.defaultValue:"";$(e).append("<input type='text' style='width:95%;padding-left:15px;' class='FormElement ui-widget ui-widget-content ui-corner-all' name='"+(b.index||b.name)+"' id='gs_"+f+"_"+b.name+"' value='"+r+
"'/>");c.prop&&$("input",e).prop(c.prop);void 0!==c.dataInit&&c.dataInit($("input",e)[0]);void 0!==c.dataEvents&&g($("input",e)[0],c.dataEvents);$("input",e).datetimepicker({changeYear:!0,firstDay:1,timeFormat:"HH:mm:ss"});!0===d.autosearch&&(d.searchOnEnter?$("input",e).keypress(function(a){return 13==(a.charCode?a.charCode:a.keyCode?a.keyCode:0)?(k(),!1):this}):$("input",e).keydown(function(a){switch(a.which){case 13:return!1;case 9:case 16:case 37:case 38:case 39:case 40:case 27:break;default:s&&
clearTimeout(s),s=setTimeout(function(){k()},500)}}));break;case "number":r=void 0!==c.defaultValue?c.defaultValue:"";$(e).append("<input type='text' class='FormElement' name='"+(b.index||b.name)+"' id='gs_"+f+"_"+b.name+"' style='float:left;width:93%;' value='"+r+"'/>");$(e).children("input").spinner({numberFormat:"n2",culture:"ru-RU",step:1}).css({width:"95%","padding-left":"15px"});c.prop&&$("input",e).prop(c.prop);void 0!==c.dataInit&&c.dataInit($("input",e)[0]);void 0!==c.dataEvents&&g($("input",
e)[0],c.dataEvents);!0===d.autosearch&&(d.searchOnEnter?$("input",e).keypress(function(a){return 13==(a.charCode?a.charCode:a.keyCode?a.keyCode:0)?(k(),!1):this}):$("input",e).keydown(function(a){switch(a.which){case 13:return!1;case 9:case 16:case 37:case 38:case 39:case 40:case 27:break;default:s&&clearTimeout(s),s=setTimeout(function(){k()},500)}}));break;default:r=void 0!==c.defaultValue?c.defaultValue:"",$(e).append("<input type='text' style='width:95%;padding-left:15px;' class='FormElement ui-widget ui-widget-content ui-corner-all' name='"+
(b.index||b.name)+"' id='gs_"+f+"_"+b.name+"' value='"+r+"'/>"),c.prop&&$("input",e).prop(c.prop),void 0!==c.dataInit&&c.dataInit($("input",e)[0]),void 0!==c.dataEvents&&g($("input",e)[0],c.dataEvents),!0===d.autosearch&&(d.searchOnEnter?$("input",e).keypress(function(a){return 13==(a.charCode?a.charCode:a.keyCode?a.keyCode:0)?(k(),!1):this}):$("input",e).keydown(function(a){switch(a.which){case 13:return!1;case 9:case 16:case 37:case 38:case 39:case 40:case 27:break;default:s&&clearTimeout(s),s=
setTimeout(function(){k()},500)}}))}"rn"!==b.name&&"checkbox"!==b.formatter&&"select"!==b.formatter&&(e.append($("<span />").attr({"class":" ui-icon  ui-icon-close",id:"search_"+f+"_"+b.name,style:"float:left;top:3px;position: absolute; cursor: pointer;",title:"\u041d\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f",value:"NONE"})),$("span.ui-icon",e).click(function(){" ui-icon  ui-icon-close"==$(this).prop("class")?$(this).attr({"class":" ui-icon  ui-icon-notice",title:"\u041d\u0435\u0440\u0430\u0432\u043d\u043e",
value:"NOT"}):" ui-icon  ui-icon-notice"==$(this).prop("class")?$(this).attr({"class":" ui-icon  ui-icon-carat-1-e",title:"\u0411\u043e\u043b\u044c\u0448\u0435",value:"MORE"}):" ui-icon  ui-icon-carat-1-e"==$(this).prop("class")?$(this).attr({"class":" ui-icon  ui-icon-carat-1-w",title:"\u041c\u0435\u043d\u044c\u0448\u0435",value:"MINI"}):" ui-icon  ui-icon-carat-1-w"==$(this).prop("class")?$(this).attr({"class":" ui-icon  ui-icon-grip-solid-horizontal",title:"\u0420\u0430\u0432\u043d\u043e",value:"EQUAL"}):
" ui-icon  ui-icon-grip-solid-horizontal"==$(this).prop("class")?$(this).attr({"class":" ui-icon  ui-icon-radio-off",title:"\u0432\u0445\u043e\u0434\u0438\u0442",value:"LIKE"}):" ui-icon  ui-icon-radio-off"==$(this).prop("class")&&$(this).attr({"class":" ui-icon  ui-icon-close",title:"\u041d\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f",value:"NONE"})}));$(h).append(e);$(t).append(h)});$("table thead",a.grid.hDiv).append(t);this.ftoolbar=!0;this.triggerToolbar=k;this.clearToolbar=
p;this.toggleToolbar=h;h()}})}});