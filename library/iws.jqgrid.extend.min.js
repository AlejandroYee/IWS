/*
* Autor Andrey Lysikov (C) 2014
* Licensed under the MIT license:
*   http://www.opensource.org/licenses/mit-license.php
* Part of IWS system
* 
*/
$.jgrid.extend({editGridRow:function(g,c){c=$.extend(!0,{modal:!0,resize:!0,mtype:"POST",addedrow:"last",reloadAfterSubmit:!0,beforeSubmit:null,afterSubmit:null,recreateForm:!1,closeOnEscape:!1,serializeEditData:null},$.jgrid.edit,c||{});var a=this;CreateEditDialog=function(f){var h=a.jqGrid("getGridParam","colModel"),t=a.jqGrid("getGridParam","colNames"),k=a.jqGrid("getGridParam","treeGrid"),b=a.attr("id"),d=$("<form />").attr({name:"FormPost",id:"editmod"+b,"class":"FormGrid",onsubmit:"return false;",
style:"text-align: left;"}),u=$("<table />").attr({id:"TblGrid_"+b,"class":"EditTable",cellspacing:"0",cellpadding:"0",border:"0"});$("#dialog_editmod"+b).dialog("destroy").remove();$(h).each(function(b){if("undefined"!==typeof h[b].editoptions){var a="",d="";$.each(h[b].editoptions,function(b,a){"value"!==b&&(d=d+b+'="'+a+'" ')});h[b].editable||(h[b].hidden=!0);h[b].edittype||(h[b].edittype="text");switch(h[b].edittype){case "text":a='<input class="FormElement ui-widget-content ui-corner-all" id="'+
h[b].index+'" name="'+h[b].index+'" type="text" '+d+' value="'+f[h[b].index]+'" />';break;case "checkbox":"1"===f[h[b].index]&&(d+='checked="checked"');a='<input class="FormElement ui-widget-content ui-corner-all" id="'+h[b].index+'" name="'+h[b].index+'" type="checkbox" '+d+" />";break;case "password":a='<input class="FormElement ui-widget-content ui-corner-all" id="'+h[b].index+'" name="'+h[b].index+'" type="password" '+d+' value="" />';break;case "textarea":a='<textarea class="FormElement ui-widget-content ui-corner-all" id="'+
h[b].index+'" '+d+' name="'+h[b].index+'" >'+f[h[b].index]+"</textarea>";break;case "select":a='<select class="FormElement ui-widget-content ui-corner-all" id="'+h[b].index+'" '+d+' name="'+h[b].index+'"  >',$.each(h[b].editoptions.value.split(";"),function(d,e){sel="";el=e.split(":");val=h[b].editoptions.multiple?f[h[b].index].split(","):f[h[b].index].split("~|");$.each(val,function(b,a){$.trim(a)===$.trim(el[0])&&(sel="selected")});a=a+'<option value="'+el[0]+'" '+sel+">"+el[1]+"</option>"}),a+=
"</select>"}h[b].editoptions.title||(h[b].editoptions.title="");table_elements=$("<tr />").attr({id:"tr_"+h[b].index,"class":"FormData",title:h[b].editoptions.title,style:h[b].hidden?"display:none":""});table_elements.append($("<td />").attr({"class":"CaptionTD",style:"width:150px;"}).append(t[b]));table_elements.append($("<td />").attr({"class":"DataTD"}).append(a));u.append(table_elements)}});if($.isFunction(create_from_table_elements)){$.isFunction(replace_select_opt_group)&&replace_select_opt_group(u);
var e=create_from_table_elements(u)+200+60}else e=710;d.append(u);d.append('<input type="hidden" name="id" value="'+g+'"><input type="hidden" name="oper" value="edit">');bSubmit=$.jgrid.edit.bSubmit;bCancel=$.jgrid.edit.bCancel;$("<div>").attr({id:"dialog_editmod"+a.attr("id"),"class":"FormElement ui-jqdialog-content"}).append(d).dialog({autoOpen:!1,modal:c.modal,minWidth:450,width:e,appendTo:$(".ui-tabs-panel[aria-expanded='true']").children(".tab_main_content"),closeOnEscape:c.closeOnEscape,resizable:c.resize,
buttons:[{text:bSubmit,click:function(){var d=$(this),e=[];$.each($("#editmod"+b).find("input, select, textarea"),function(){var b=$(this);e[b.attr("name")]=b.val()});e=$.extend({},e);"new"===e.id&&(e.oper="add",k&&(e.ID_PARENT=a.jqGrid("getGridParam","selrow")));var f=!0;$.isFunction(c.serializeEditData)&&(e=c.serializeEditData.call(c,e));$.isFunction(c.beforeSubmit)&&(ret=c.beforeSubmit.call(c,e,$("#editmod"+b)),f="undefined"!==typeof ret?ret[0]:!1);f&&($("#btn_s_"+b).button("option","disabled",
!0),$("#btn_c_"+b).button("option","disabled",!0),$.ajax({url:a.jqGrid("getGridParam","editurl"),datatype:"json",data:e,cache:!1,type:c.mtype,success:function(h,t){f=!0;var n={};n.statusText=t;n.responseText=h;$.isFunction(c.afterSubmit)&&(ret=c.afterSubmit.call(c,n,e,b),f="undefined"!==typeof ret?ret[0]:!1);f&&("add"!==e.oper?a.jqGrid("setRowData",g,e):k?a.jqGrid("addChildNode",ret[3],e.ID_PARENT,e):a.jqGrid("addRowData",ret[3],e,c.addedrow),d.dialog("close"));$("#btn_s_"+b).button("option","disabled",
!1);$("#btn_c_"+b).button("option","disabled",!1)}}))}},{text:bCancel,click:function(){$(this).dialog("close")}}],close:function(){$(this).dialog("close")},open:function(){var a=$(this).parent();a.children(".ui-dialog-buttonpane").find('button:contains("'+bCancel+'")').button({icons:{primary:"ui-icon-close"}}).prop("id","btn_c_"+b);a.children(".ui-dialog-buttonpane").find('button:contains("'+bSubmit+'")').button({icons:{primary:"ui-icon-disk"}}).prop("id","btn_s_"+b);a.parent().css("z-index",110).parent().children(".ui-widget-overlay").css("z-index",
105);redraw_document()}})};var f=$("#editmod"+a.attr("id"));if("new"!==g)var l=a.jqGrid("getRowData",g);else{var l=[],k=a.jqGrid("getGridParam","colModel");$(k).each(function(a){"undefined"!==typeof k[a].editoptions&&(l[k[a].index]="")});l=$.extend({},l)}c.recreateForm||0===f.length?CreateEditDialog(l):(f=$("#editmod"+a.attr("id")),$.each(l,function(a,f){var c=$("#"+a);"SB"===c.attr("row_type")?(c.children("option").removeAttr("selected"),f=c.attr("multiple")?f.split(","):f.split("~|"),$.each(f,function(a,
b){c.find("option[value='"+$.trim(b)+"']").attr("selected","")})):"B"===c.attr("row_type")?"1"===f?c.attr({checked:"checked"}):c.removeAttr("checked"):c.val(f)}),$.isFunction(replace_select_opt_group)&&replace_select_opt_group(f),$.isFunction(update_table_elemnts)&&update_table_elemnts(f));f.find('input[name="oper"]').val("edit");f.find('input[name="id"]').val(g);$("#dialog_editmod"+a.attr("id")).dialog("option","title",c.editCaption).dialog("open")},viewGridRow:function(g,c){c=$.extend(!0,{modal:!1,
resize:!0,closeOnEscape:!1,viewPagerButtons:!0},$.jgrid.view,c||{});var a=0,f=this.jqGrid("getGridParam","colModel"),l=this.jqGrid("getGridParam","colNames"),k=this.attr("id"),n=this.jqGrid("getRowData",g),h=$("<table />").attr({id:"TblGrid_"+k,"class":"EditTable",cellspacing:"0",cellpadding:"0",border:"0"});$(f).each(function(c){if("undefined"!==typeof f[c].editoptions){f[c].edittype||(f[c].edittype="text");f[c].editable||(f[c].hidden=!0);var g="disabled ";$.each(f[c].editoptions,function(b,d){"value"!==
b&&("w"===b&&(parseInt(d)>a&&(a=parseInt(d)),b="style",d="width:"+d+"px;"),g=g+b+'="'+d+'" ')});switch(f[c].edittype){case "text":elem='<input class="FormElement ui-widget-content ui-corner-all"  type="text" '+g+' value="'+n[f[c].index]+'" />';break;case "checkbox":"1"===n[f[c].index]&&(g+='checked="checked"');elem='<input class="FormElement ui-widget-content ui-corner-all" type="checkbox" '+g+" />";break;case "password":elem='<input class="FormElement ui-widget-content ui-corner-all" type="password" '+
g+' value="" />';break;case "textarea":elem='<textarea class="FormElement ui-widget-content ui-corner-all" '+g+">"+n[f[c].index]+"</textarea>";break;case "select":case "select":elem='<select class="FormElement ui-widget-content ui-corner-all"  '+g+"  >",$.each(f[c].editoptions.value.split(";"),function(b,a){sel="";el=a.split(":");val=f[c].editoptions.multiple?n[f[c].index].split(","):n[f[c].index].split("~|");$.each(val,function(b,a){$.trim(a)===$.trim(el[0])&&(sel="selected")});elem=elem+'<option value="'+
el[0]+'" '+sel+">"+el[1]+"</option>"}),elem+="</select>"}f[c].editoptions.title||(f[c].editoptions.title="");table_elements=$("<tr />").attr({id:"tr_"+f[c].index,"class":"FormData",title:f[c].editoptions.title,style:f[c].hidden?"display:none":""});table_elements.append($("<td />").attr({"class":"CaptionTD",style:"width:150px;text-align:left;padding:5px;"}).append("<b>"+l[c]+"</b>"));table_elements.append($("<td />").attr({"class":"DataTD",style:"text-align:left;padding:5px;"}).append(elem));h.append(table_elements)}});
$("<div>").attr({id:"dialog_viewmod"+this.attr("id"),"class":"FormElement ui-jqdialog-content"}).append(h).dialog({autoOpen:!0,modal:!0,minWidth:350,appendTo:$(".ui-tabs-panel[aria-expanded='true']").children(".tab_main_content"),title:$.jgrid.view.caption,closeOnEscape:c.closeOnEscape,resizable:c.resize,width:a+300,buttons:[{text:$.jgrid.view.bClose,click:function(){$(this).dialog("close")}}],close:function(){$(this).dialog("close");$(this).dialog("destroy").remove()},open:function(){var a=$(this).parent();
a.children(".ui-dialog-buttonpane").find('button:contains("'+$.jgrid.view.bClose+'")').button({icons:{primary:"ui-icon-close"}}).prop("id","btn_c_"+k);a.parent().css("z-index",110).parent().children(".ui-widget-overlay").css("z-index",105);redraw_document()}})},delGridRow:function(g,c){c=$.extend(!0,{resize:!0,mtype:"POST"},$.jgrid.del,c||{});var a=this,f=a.attr("id");$.isArray(g)&&(g=g.join(","));$("<div>").attr({id:"dialog_delmod"+a.attr("id"),"class":"FormElement ui-jqdialog-content"}).append($.jgrid.del.msg).dialog({autoOpen:!0,
modal:!0,minWidth:350,appendTo:$(".ui-tabs-panel[aria-expanded='true']").children(".tab_main_content"),title:$.jgrid.del.caption,closeOnEscape:c.closeOnEscape,resizable:c.resize,buttons:[{text:$.jgrid.del.bSubmit,click:function(){var l=$(this);$("#btn_d_"+f).button("option","disabled",!0);$("#btn_c_"+f).button("option","disabled",!0);var k={};k.id=g;k.oper="del";$.ajax({url:a.jqGrid("getGridParam","editurl"),datatype:"json",data:k,cache:!1,type:c.mtype,success:function(c,h){$.each(g.split(","),function(f,
c){a.jqGrid("delRowData",c)});l.dialog("close");$("#btn_d_"+f).button("option","disabled",!1);$("#btn_c_"+f).button("option","disabled",!1)}})}},{text:$.jgrid.del.bCancel,click:function(){$(this).dialog("close")}}],close:function(){$(this).dialog("close");$(this).dialog("destroy").remove()},open:function(){var a=$(this).parent();a.children(".ui-dialog-buttonpane").find('button:contains("'+$.jgrid.del.bCancel+'")').button({icons:{primary:"ui-icon-close"}}).prop("id","btn_c_"+f);a.children(".ui-dialog-buttonpane").find('button:contains("'+
$.jgrid.del.bSubmit+'")').button({icons:{primary:"ui-icon-trash"}}).prop("id","btn_d_"+f);a.parent().css("z-index",110).parent().children(".ui-widget-overlay").css("z-index",105);redraw_document()}})},columnChooser:function(g){var c=this;if(!$("#colchooser_"+$.jgrid.jqID(c[0].p.id)).length){var a=c.jqGrid("getGridParam","colModel"),f=c.jqGrid("getGridParam","colNames"),l=$("<div />").attr({id:"colchooser_"+c[0].p.id,style:"position:relative;overflow-y:enable"}),k=$("<ol />").attr({style:"list-style-type: none; margin: 0; padding: 0; width: 100%;"});
k.bind("mousedown",function(a){a.metaKey=!0}).selectable({selected:function(a,c){$(c.selected).addClass("ui-state-active")},unselected:function(a,c){$(c.unselected).removeClass("ui-state-active")}});$.each(a,function(a){this.hidedlg||(a=$("<li />").attr({value:a,"class":"ui-widget-content ui-state-default",style:"margin: 3px; padding: 0.4em; font-size: 0.8em; height: 12px; text-align:left; cursor:pointer;"}).text(f[a].replace("<br>"," ").replace("<BR>"," ")),this.hidden||a.addClass("ui-state-active").addClass("ui-selected"),
k.append(a))});l.append(k).dialog({autoOpen:!0,modal:!0,appendTo:$(".ui-tabs-panel[aria-expanded='true']").children(".tab_main_content"),title:$.jgrid.col.caption,width:g.width,height:g.height,resizable:!0,buttons:[{text:$.jgrid.col.bSubmit,click:function(){$.each(k.find("li"),function(f,g){var k=$(this).val();$(this).hasClass("ui-selected")?c.jqGrid("showCol",a[k].name):c.jqGrid("hideCol",a[k].name)});$(this).dialog("close")}},{text:$.jgrid.col.bCancel,click:function(){$(this).dialog("close")}}],
close:function(){$(this).dialog("close");$(this).dialog("destroy").remove();redraw_document()},open:function(){var a=$(this).parent();a.children(".ui-dialog-buttonpane").find('button:contains("'+$.jgrid.col.bCancel+'")').button({icons:{primary:"ui-icon-close"}});a.children(".ui-dialog-buttonpane").find('button:contains("'+$.jgrid.col.bSubmit+'")').button({icons:{primary:"ui-icon-disk"}});a.parent().css("z-index",110).parent().children(".ui-widget-overlay").css("z-index",105);redraw_document()}})}},
filterToolbar:function(g){g=$.extend({autosearch:!0,searchOnEnter:!0,beforeSearch:null,afterSearch:null,beforeClear:null,afterClear:null,searchurl:"",stringResult:!1,groupOp:"AND",defaultSearch:"bw"},g||{});return this.each(function(){function c(a,d){var c=$(a);c[0]&&jQuery.each(d,function(){void 0!==this.data?c.bind(this.type,this.data,this.fn):c.bind(this.type,this.fn)})}var a=this,f=$(this).parent().parent().parent().prop("id"),l=!1;if(!this.ftoolbar){var k=function(){var b={},d=0,c,e,h={},k;$.each(a.p.colModel,
function(){e=this.index||this.name;k=this.searchoptions&&this.searchoptions.sopt?this.searchoptions.sopt[0]:"select"==this.stype?"eq":g.defaultSearch;c=$("#gs_"+f+"_"+$.jgrid.jqID(this.name),!0===this.frozen&&!0===a.p.frozenColumns?a.grid.fhDiv:a.grid.hDiv).val();l=!0;if(c)" ui-icon  ui-icon-close"==$("#search_"+f+"_"+$.jgrid.jqID(this.name)).prop("class")&&$("#search_"+f+"_"+$.jgrid.jqID(this.name)).attr({"class":" ui-icon  ui-icon-radio-off",title:"\u0432\u0445\u043e\u0434\u0438\u0442",value:"LIKE"}),
b[e]=$("#search_"+f+"_"+$.jgrid.jqID(this.name)).attr("value")+">"+$("#gs_"+f+"_"+$.jgrid.jqID(this.name)).prop("value"),h[e]=k,d++;else try{delete a.p.postData[e]}catch(v){}});var q=0<d?!0:!1;if(!0===g.stringResult||"local"==a.p.datatype){var m='{"groupOp":"'+g.groupOp+'","rules":[',p=0;$.each(b,function(a,b){0<p&&(m+=",");m+='{"field":"'+a+'",';m+='"op":"'+h[a]+'",';m+='"data":"'+(b+"").replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}';p++});m+="]}";$.extend(a.p.postData,{filters:m});$.each(["searchField",
"searchString","searchOper"],function(b,d){a.p.postData.hasOwnProperty(d)&&delete a.p.postData[d]})}else $.extend(a.p.postData,b);var s;a.p.searchurl&&(s=a.p.url,$(a).jqGrid("setGridParam",{url:a.p.searchurl}));var v="stop"===$(a).triggerHandler("jqGridToolbarBeforeSearch")?!0:!1;!v&&$.isFunction(g.beforeSearch)&&(v=g.beforeSearch.call(a));v||$(a).jqGrid("setGridParam",{search:q}).trigger("reloadGrid",[{page:1}]);s&&$(a).jqGrid("setGridParam",{url:s});$(a).triggerHandler("jqGridToolbarAfterSearch");
$.isFunction(g.afterSearch)&&g.afterSearch.call(a)},n=function(b){var d={},c=0,e;b="boolean"!=typeof b?!0:b;$.each(a.p.colModel,function(){var b;this.searchoptions&&void 0!==this.searchoptions.defaultValue&&(b=this.searchoptions.defaultValue);e=this.index||this.name;$("#search_"+f+"_"+$.jgrid.jqID(this.name)).prop({"class":" ui-icon  ui-icon-close",title:"\u041d\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f",value:"NONE"});$("#gs_"+f+"_"+$.jgrid.jqID(this.name)).prop({value:""});
switch(this.stype){case "select":$("#gs_"+$.jgrid.jqID(this.name)+" option",!0===this.frozen&&!0===a.p.frozenColumns?a.grid.fhDiv:a.grid.hDiv).each(function(a){0===a&&(this.selected=!0);if($(this).val()==b)return this.selected=!0,!1});if(void 0!==b)d[e]=b,c++;else try{delete a.p.postData[e]}catch(g){}break;case "text":if($("#gs_"+$.jgrid.jqID(this.name),!0===this.frozen&&!0===a.p.frozenColumns?a.grid.fhDiv:a.grid.hDiv).val(b),void 0!==b)d[e]=b,c++;else try{delete a.p.postData[e]}catch(k){}}});var h=
0<c?!0:!1;if(!0===g.stringResult||"local"==a.p.datatype){var k='{"groupOp":"'+g.groupOp+'","rules":[',l=0;$.each(d,function(a,b){0<l&&(k+=",");k+='{"field":"'+a+'",';k+='"op":"eq",';k+='"data":"'+(b+"").replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}';l++});k+="]}";$.extend(a.p.postData,{filters:k});$.each(["searchField","searchString","searchOper"],function(b,c){a.p.postData.hasOwnProperty(c)&&delete a.p.postData[c]})}else $.extend(a.p.postData,d);var m;a.p.searchurl&&(m=a.p.url,$(a).jqGrid("setGridParam",
{url:a.p.searchurl}));var p="stop"===$(a).triggerHandler("jqGridToolbarBeforeClear")?!0:!1;!p&&$.isFunction(g.beforeClear)&&(p=g.beforeClear.call(a));p||b&&$(a).jqGrid("setGridParam",{search:h}).trigger("reloadGrid",[{page:1}]);m&&$(a).jqGrid("setGridParam",{url:m});$(a).triggerHandler("jqGridToolbarAfterClear");$.isFunction(g.afterClear)&&g.afterClear()},h=function(){var b=$("tr.ui-search-toolbar",a.grid.hDiv),c=!0===a.p.frozenColumns?$("tr.ui-search-toolbar",a.grid.fhDiv):!1;"none"==b.css("display")?
(b.show(),$("#"+f).children(".ui-jqgrid-bdiv").height($("#"+f).children(".ui-jqgrid-bdiv").height()-27),l=!1,c&&c.show()):(b.hide(),$("#"+f).children(".ui-jqgrid-bdiv").height($("#"+f).children(".ui-jqgrid-bdiv").height()+27),l&&n(),c&&c.hide())},t=$("<tr class='ui-search-toolbar' role='rowheader'></tr>"),r;$.each(a.p.colModel,function(){var b=this,d,h,e,l;h=$("<th role='columnheader' class='ui-state-default ui-th-column ui-th-"+a.p.direction+"'></th>");d=$("<div style='text-align:left;position:relative;vertical-align:middle'></div>");
!0===this.hidden&&$(h).css("display","none");this.search=!1===this.search?!1:!0;"undefined"==typeof b.formatter&&(b.formatter="text");e=$.extend({},this.searchoptions||{});if(this.search)switch(b.formatter){case "select":if(l=this.surl||e.dataUrl)$.ajax($.extend({url:l,dataType:"html",success:function(a){void 0!==e.buildSelect?(a=e.buildSelect(a))&&$(d).append(a):$(d).append(a);void 0!==e.defaultValue&&$("select",d).val(e.defaultValue);$("select",d).prop({name:b.index||b.name,id:"gs_"+f+"_"+b.name});
$("select",d).css("float","left").css("padding-left","15px");$("select",d).prop("class","ui-state-default");e.prop&&$("select",d).prop(e.prop);$("select",d).css({width:"100%"});void 0!==e.dataInit&&e.dataInit($("select",d)[0]);void 0!==e.dataEvents&&c($("select",d)[0],e.dataEvents);!0===g.autosearch&&$("select",d).change(function(){k();return!1});a=null}},$.jgrid.ajaxOptions,a.p.ajaxSelectOptions||{}));else{var n,q,m;b.searchoptions?(n=void 0===b.searchoptions.value?"":b.searchoptions.value,q=void 0===
b.searchoptions.separator?":":b.searchoptions.separator,m=void 0===b.searchoptions.delimiter?";":b.searchoptions.delimiter):b.editoptions&&(n=void 0===b.editoptions.value?"":b.editoptions.value,q=void 0===b.editoptions.separator?":":b.editoptions.separator,m=void 0===b.editoptions.delimiter?";":b.editoptions.delimiter);if(n){l=document.createElement("select");l.style.width="100%";$(l).prop({name:b.index||b.name,id:"gs_"+f+"_"+b.name});var p;if("string"===typeof n){n=n.split(m);for(var s=0;s<n.length;s++)p=
n[s].split(q),m=document.createElement("option"),m.value=p[0],m.innerHTML=p[1],l.appendChild(m)}else if("object"===typeof n)for(p in n)n.hasOwnProperty(p)&&(m=document.createElement("option"),m.value=p,m.innerHTML=n[p],l.appendChild(m));void 0!==e.defaultValue&&$(l).val(e.defaultValue);e.prop&&$(l).prop(e.prop);void 0!==e.dataInit&&e.dataInit(l);void 0!==e.dataEvents&&c(l,e.dataEvents);$(d).append(l);replace_select_opt_group($(d));1<$(d).find("option:empty").length&&$(d).find("option:empty:first").remove();
$(d).children("select").multiselect({multiple:void 0===b.editoptions.multiple?!1:b.editoptions.multiple,minWidth:b.width,header:!1,selectedList:void 0===b.editoptions.size?1:b.editoptions.size}).css("padding","0.3em");!0===g.autosearch&&$(l).change(function(){k();return!1})}}break;case "checkbox":q=void 0!==e.defaultValue?e.defaultValue:"";$(d).append("<input type='checkbox' class='ui-widget ui-widget-content ui-corner-all' name='"+(b.index||b.name)+"' id='gs_"+f+"_"+b.name+"' value=''/>");$(d).css("text-align",
"center");$(d).children("input").before("<label for='gs_"+f+"_"+b.name+"'>\u0412\u043a\u043b\u044e\u0447\u0435\u043d\u043e \u0438\u043b\u0438 \u0432\u044b\u043a\u043b\u044e\u0447\u0435\u043d\u043e</label>").button({icons:{primary:"ui-icon-check"},text:!1});e.prop&&$("input",d).prop(e.prop);void 0!==e.dataInit&&e.dataInit($("input",d)[0]);void 0!==e.dataEvents&&c($("input",d)[0],e.dataEvents);!0===g.autosearch&&$("input",d).click(function(){"1"==$("input",d).prop("value")?$("input",d).prop({value:"0"}):
$("input",d).prop({value:"1"});k()});break;case "date":q=void 0!==e.defaultValue?e.defaultValue:"";$(d).append("<input type='text' style='width:95%;padding-left:15px;' class='FormElement ui-widget ui-widget-content ui-corner-all' name='"+(b.index||b.name)+"' id='gs_"+f+"_"+b.name+"' value='"+q+"'/>");e.prop&&$("input",d).prop(e.prop);void 0!==e.dataInit&&e.dataInit($("input",d)[0]);void 0!==e.dataEvents&&c($("input",d)[0],e.dataEvents);$("input",d).datetimepicker({changeYear:!0,firstDay:1,timeFormat:"HH:mm:ss"});
!0===g.autosearch&&(g.searchOnEnter?$("input",d).keypress(function(a){return 13==(a.charCode?a.charCode:a.keyCode?a.keyCode:0)?(k(),!1):this}):$("input",d).keydown(function(a){switch(a.which){case 13:return!1;case 9:case 16:case 37:case 38:case 39:case 40:case 27:break;default:r&&clearTimeout(r),r=setTimeout(function(){k()},500)}}));break;case "number":q=void 0!==e.defaultValue?e.defaultValue:"";$(d).append("<input type='text' class='FormElement' name='"+(b.index||b.name)+"' id='gs_"+f+"_"+b.name+
"' style='float:left;width:93%;' value='"+q+"'/>");$(d).children("input").spinner({numberFormat:"n2",culture:"ru-RU",step:1}).css({width:"95%","padding-left":"15px"});e.prop&&$("input",d).prop(e.prop);void 0!==e.dataInit&&e.dataInit($("input",d)[0]);void 0!==e.dataEvents&&c($("input",d)[0],e.dataEvents);!0===g.autosearch&&(g.searchOnEnter?$("input",d).keypress(function(a){return 13==(a.charCode?a.charCode:a.keyCode?a.keyCode:0)?(k(),!1):this}):$("input",d).keydown(function(a){switch(a.which){case 13:return!1;
case 9:case 16:case 37:case 38:case 39:case 40:case 27:break;default:r&&clearTimeout(r),r=setTimeout(function(){k()},500)}}));break;default:q=void 0!==e.defaultValue?e.defaultValue:"",$(d).append("<input type='text' style='width:95%;padding-left:15px;' class='FormElement ui-widget ui-widget-content ui-corner-all' name='"+(b.index||b.name)+"' id='gs_"+f+"_"+b.name+"' value='"+q+"'/>"),e.prop&&$("input",d).prop(e.prop),void 0!==e.dataInit&&e.dataInit($("input",d)[0]),void 0!==e.dataEvents&&c($("input",
d)[0],e.dataEvents),!0===g.autosearch&&(g.searchOnEnter?$("input",d).keypress(function(a){return 13==(a.charCode?a.charCode:a.keyCode?a.keyCode:0)?(k(),!1):this}):$("input",d).keydown(function(a){switch(a.which){case 13:return!1;case 9:case 16:case 37:case 38:case 39:case 40:case 27:break;default:r&&clearTimeout(r),r=setTimeout(function(){k()},500)}}))}"rn"!==b.name&&"checkbox"!==b.formatter&&"select"!==b.formatter&&(d.append($("<span />").attr({"class":" ui-icon  ui-icon-close",id:"search_"+f+"_"+
b.name,style:"float:left;top:3px;position: absolute; cursor: pointer;",title:"\u041d\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f",value:"NONE"})),$("span.ui-icon",d).click(function(){" ui-icon  ui-icon-close"==$(this).prop("class")?$(this).attr({"class":" ui-icon  ui-icon-notice",title:"\u041d\u0435\u0440\u0430\u0432\u043d\u043e",value:"NOT"}):" ui-icon  ui-icon-notice"==$(this).prop("class")?$(this).attr({"class":" ui-icon  ui-icon-carat-1-e",title:"\u0411\u043e\u043b\u044c\u0448\u0435",
value:"MORE"}):" ui-icon  ui-icon-carat-1-e"==$(this).prop("class")?$(this).attr({"class":" ui-icon  ui-icon-carat-1-w",title:"\u041c\u0435\u043d\u044c\u0448\u0435",value:"MINI"}):" ui-icon  ui-icon-carat-1-w"==$(this).prop("class")?$(this).attr({"class":" ui-icon  ui-icon-grip-solid-horizontal",title:"\u0420\u0430\u0432\u043d\u043e",value:"EQUAL"}):" ui-icon  ui-icon-grip-solid-horizontal"==$(this).prop("class")?$(this).attr({"class":" ui-icon  ui-icon-radio-off",title:"\u0432\u0445\u043e\u0434\u0438\u0442",
value:"LIKE"}):" ui-icon  ui-icon-radio-off"==$(this).prop("class")&&$(this).attr({"class":" ui-icon  ui-icon-close",title:"\u041d\u0435\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f",value:"NONE"})}));$(h).append(d);$(t).append(h)});$("table thead",a.grid.hDiv).append(t);this.ftoolbar=!0;this.triggerToolbar=k;this.clearToolbar=n;this.toggleToolbar=h;h()}})}});